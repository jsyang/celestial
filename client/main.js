webpackJsonp([0],[,,,,function(t,e,n){"use strict";function a(t,e){var n=e.x-t.x,a=e.y-t.y;return n*n+a*a}function i(t){var e=r.a.getByType(t);e&&e.forEach(o.a.update)}e.b=a;var o=n(265),r=n(288),c=n(11),s=n(289),l=n(290),p=n(291),u=n(292),h=n(293),f=n(294),y=n(295),d=n(126),g=n(296),m=n(297),b=n(298),_=n(299),O=n(300),T=n(127),S={Fighter:l.a,Freighter:p.a,PBase:u.a,PColony:h.a,PComm:f.a,PLab:y.a,Planet:d.a,Probe:g.a,SensorArray:m.a,Shot:b.a,SpaceDock:_.a,SpacePort:O.a,Star:T.a},v=["Star","Planet","PBase","PColony","PComm","PLab","SpacePort","SpaceDock","SensorArray","Fighter","Freighter","Shot"];e.a={create:function(t,e){var n;return t in S&&(n=new S[t](e),o.a.init(n),r.a.add(n)),n},updateAll:function(){v.forEach(i)},commit:s.a.commit,prepareNext:s.a.prepareNext,getNearest:s.a.getNearest,getNearestEnemyTarget:s.a.getNearestEnemyTarget,destroy:r.a.remove,getByType:r.a.getByType,getAbsoluteNearestByType:r.a.getAbsoluteNearestByType,getTeamColor:function(t){return c.a._COLORS[t]},getDistSquared:a,getAngleFromTo:function(t,e){var n=e.x-t.x,a=e.y-t.y;return Math.atan2(a,n)},TEAM:c.a}},,,function(t,e,n){"use strict";var a=n(11),i=function(){function t(){this.team=a.a.NONE}return Object.defineProperty(t.prototype,"x",{get:function(){return this.geo.x},set:function(t){this.geo.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.geo.y},set:function(t){this.geo.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.geo.rotation},set:function(t){this.geo.rotation=t},enumerable:!0,configurable:!0}),t.prototype.getChildAt=function(t){return this.geo.graphics.getChildAt(t)},t.prototype.setChildVisible=function(t,e){this.getChildAt(t).visible=e},t.prototype.assignTeamColor=function(){this.geo.graphics.currentPath.lineColor=a.a._COLORS[this.team]},t.prototype.renderHit=function(){this.hitTime>0?(this.hitTime--,this.geo.graphics.alpha=Math.random()):0===this.hitTime&&(this.hitTime=-1,this.geo.graphics.alpha=1)},t}();e.a=i},function(t,e,n){"use strict";e.b=function(t,e){var n=t.x,a=t.y;return Object(i.pointInPolygon)(r(n,a),e.geo.collider)},e.a=function(t,e){void 0===e&&(e={});var n,s=(t=o({},t,{options:e})).lineStyle,l=t.fill,p=t.path,u=t.radius,h=t.x,f=t.y,y=t.collisionPath,d=new a.Graphics;s&&d.lineStyle(s.width,s.color,s.alpha),l?d.beginFill(l.color,l.alpha):d.beginFill(0,0),d.x=h||0,d.y=f||0;var g=r(d.x,d.y);if("circle"===t.type)d.drawCircle(0,0,u),n=new i.Circle(g,u);else{for(var m=[],b=y||p,_=0;_<b.length;_+=2)m.push(r(b[_],b[_+1]));d.drawPolygon(p),n=new i.Polygon(g,m)}return d.endFill(),{set x(t){t<0?t=0:t>32768&&(t=32768),this.graphics.x=t,this.collider.pos.x=t},set y(t){t<0?t=0:t>32768&&(t=32768),this.graphics.y=t,this.collider.pos.y=t},set rotation(t){t>c?t-=c:t<-c&&(t+=c),this.collider instanceof i.Circle||(this.collider.setAngle(t),this.graphics.rotation=t)},get x(){return this.graphics.x},get y(){return this.graphics.y},get rotation(){return this.graphics.rotation},graphics:d,collider:n}};var a=n(18),i=(n.n(a),n(282)),o=(n.n(i),this&&this.__assign||Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}),r=function(t,e){return new i.Vector(t,e)},c=2*Math.PI},,,function(t,e,n){"use strict";e.a={_COLORS:[255,65280,16711680,16776960,16711935],NONE:-1,BLUE:0,GREEN:1,RED:2,YELLOW:3,MAGENTA:4}},,,,function(t,e,n){"use strict";var a=function(t,e){return Math.round(i(t,e))},i=function(t,e){return t+Math.random()*(e-t)};e.a={int:a,float:i,arrayElement:function(t){return t[a(0,t.length-1)]}}},,,,,,,function(t,e,n){"use strict";function a(){r=innerWidth,s=innerHeight,c=r>>1,l=s>>1,o&&o.resize(r,s)}n.d(e,"a",function(){return h});var i=n(18);n.n(i),i.settings.SCALE_MODE=i.SCALE_MODES.NEAREST;var o,r,c,s,l,p=new i.Container,u=new i.Container,h=function(t){return p.addChild(t)};e.b={init:function(){void 0===o&&(a(),addEventListener("resize",a),p.addChild(u),o=new i.WebGLRenderer(r,s),document.body.appendChild(o.view))},setGlobalAlpha:function(t){return p.alpha=t},addChild:function(t){return u.addChild(t)},removeChild:function(t){return u.removeChild(t)},removeAllChildren:function(){for(;u.children[0];)u.removeChild(u.children[0]);for(;p.children[0];)p.removeChild(p.children[0]);p.addChild(u)},render:function(){return o.render(p)},centerOn:function(t){t&&(u.x=c-t.x,u.y=l-t.y)},addChildToHUD:h}},function(t,e,n){"use strict";e.a=function(t){var e=t.name,n=t.arrayBuffer;a.decodeAudioData(n).then(function(t){i[e]=t})},e.b=function(t){var e=a.createBufferSource();e.buffer=i[t],e.connect(a.destination),e.start()};var a=new AudioContext,i={}},,,,,,,,,,function(t,e,n){"use strict";n.d(e,"a",function(){return a});var a=32768},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var a,i=n(7);e.a={getFocus:function(){return a instanceof i.a?{x:a.x,y:a.y}:a},setFocus:function(t){return a=t}}},function(t,e,n){"use strict";var a,i,o=n(60),r=n(260),c=n(261),s=n(123),l=n(262),p=n(263),u=function(t){return a=t};!function(t){t[t.Keyboard=0]="Keyboard",t[t.GamePad=1]="GamePad"}(i||(i={}));var h=localStorage.getItem("input.device")||i.Keyboard;e.a={getDevice:function(){return h===i.Keyboard?c.a:r.a},processGameScreen:function(){var t,e;switch(h){case i.GamePad:t=r.a.getEvents(),e=r.a.getInputState();break;case i.Keyboard:default:t=c.a.getEvents(),e=c.a.getInputState()}if(a)if(a.hp>0)switch(s.a.setIconVisible(!1),o.a.setFocus(a),a.type){case"Fighter":Object(l.a)(a,t)}else Object(p.b)(a),u(null);else o.a.setFocus(Object(p.a)(e)),s.a.setIconVisible(!0)},setControlledEntity:u}},,,,,,,,,function(t,e,n){"use strict";function a(t){var e=t.color,n=t.size,a=t.x,i=t.y,o=new c.Graphics;return o.beginFill(e),o.drawRect(0,0,n,n),o.lineWidth=n,o.endFill(),o.x=a,o.y=i,o}function i(){f=null}function o(t){if(t){var e=t.x,n=t.y,a=0,i=0;f?(a=e-f.x,i=n-f.y):function(t){u=innerWidth>>1,h=innerHeight>>1,l.forEach(function(e){e.x=t.x+s.a.float(-u,u),e.y=t.y+s.a.float(-h,h)})}(t),l.forEach(function(t,e,n,a){1===a.lineWidth?(t*=p.DIM.speed,e*=p.DIM.speed):(t*=p.BRIGHT.speed,e*=p.BRIGHT.speed),a.x+=t,a.y+=e,a.x<n.x-u?a.x=n.x+u:a.x>n.x+u&&(a.x=n.x-u),a.y<n.y-h?a.y=n.y+h:a.y>n.y+h&&(a.y=n.y-h)}.bind(null,a,i,t)),f={x:e,y:n}}else f=null}var r,c=n(18),s=(n.n(c),n(15)),l=[],p={BRIGHT:{speed:.01,count:8,size:2,color:11184810,x:0,y:0},DIM:{speed:.3,count:20,size:1,color:15790320,x:0,y:0}},u=innerWidth>>1,h=innerHeight>>1,f=null;e.a={init:function(){var t;if(0===l.length){for(t=0;t<p.DIM.count;t++)l.push(a(p.DIM));for(t=0;t<p.BRIGHT.count;t++)l.push(a(p.BRIGHT))}else o(null);return r||(r=addEventListener("resize",i)),l},process:o}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function a(){r.x=innerWidth-p,r.y=p}var i=n(18),o=(n.n(i),n(22)),r=new i.Graphics,c=[0,0,-1,-1,-.5,-1,-1,-1,-1,-.5,-1,-1].map(function(t){return 16*t}),s=function(t){var e=new i.Graphics;return e.lineStyle(1,34816,1),e.x=0,e.y=0,e.beginFill(0,0),e.lineWidth=1,e.drawPolygon(c),e.endFill(),e.rotation=t,e};r.addChild(s(0),s(.5*Math.PI),s(Math.PI),s(1.5*Math.PI));var l=function(t){return r.visible=t},p=20;e.a={init:function(){Object(o.a)(r),a(),l(!1),addEventListener("resize",a)},symbol:r,setIconVisible:l}},function(t,e,n){"use strict";var a=n(4),i={isDockedPlanet:!1,dockPlanet:function(t){this.isDockedPlanet=!0,this.dx=0,this.dy=0,this.rotation=a.a.getAngleFromTo(t,this),this.planet=t,t.isOccupied()||(t.team=this.team,t.updateFlagColor())},undockPlanet:function(){this.isDockedPlanet=!1,this.planet=void 0}};e.a={componentFlag:"canDockPlanet",DEFAULTS:i,process:function(t){t.isDockedPlanet&&(t.x=105*Math.cos(t.rotation)+t.planet.x,t.y=105*Math.sin(t.rotation)+t.planet.y)}}},function(t,e,n){"use strict";var a=n(4),i={enterPlanetOrbit:function(t){this.isOrbitingPlanet=!0,this.dx=0,this.dy=0,this.orbitRotation=a.a.getAngleFromTo(t,this),this.rotation=this.orbitRotation+o,this.planet=t,this.target=void 0,this.flameOff&&this.flameOff()},exitPlanetOrbit:function(){this.isOrbitingPlanet=!1,this.planet=void 0,this.flameOn&&this.flameOn()},isOrbitingPlanet:!0,D_ROTATION:1e-4,orbitDistance:105,orbitRotation:0},o=.5*Math.PI;e.a={componentFlag:"canOrbitPlanet",DEFAULTS:i,process:function(t){t.isOrbitingPlanet&&t.planet&&("SpacePort"===t.type?t.rotation=a.a.getAngleFromTo(t.planet,t):"Freighter"===t.type&&(t.rotation+=t.D_ROTATION),t.orbitRotation+=t.D_ROTATION,t.x=Math.cos(t.orbitRotation)*t.orbitDistance+t.planet.x,t.y=Math.sin(t.orbitRotation)*t.orbitDistance+t.planet.y)}}},function(t,e,n){"use strict";var a=n(11),i=n(8),o=n(7),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c={body:{type:"circle",radius:100,fill:{color:0,alpha:1},lineStyle:{width:1,color:65280,alpha:1}},flag:{type:"polygon",fill:{color:16777215,alpha:1},path:[-5,-4,-5,4,5,4,5,-4]}},s=function(t){function e(e){var n=t.call(this)||this;return n.type="Planet",n.canOrbitStar=!0,n.canStoreMaterial=!0,n.materialsRaw=0,n.materialsFinished=0,n.hp=2e3,n.mass=180,n.geo=Object(i.a)(c.body),n.geo.graphics.addChild(Object(i.a)(c.flag).graphics),Object.assign(n,e),n.updateFlagColor(),n}return r(e,t),e.prototype.isOccupied=function(){return Boolean(this.pbase||this.plab||this.pcolony||this.pcomm)},e.prototype.updateFlagColor=function(){var t=this.geo.graphics.children[0];this.team===a.a.NONE?t.visible=!1:(window.foo=t,window.doo=this,t.visible=!0,t.tint=a.a._COLORS[this.team])},e.DIST_SURFACE2=11025,e}(o.a);e.a=s},function(t,e,n){"use strict";var a=n(8),i=n(7),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r={type:"circle",radius:200,fill:{color:0,alpha:1},lineStyle:{width:1,color:16776960,alpha:1}},c=function(t){function e(e){var n=t.call(this)||this;return n.type="Star",n.hp=1e4,n.mass=600,n.geo=Object(a.a)(r),Object.assign(n,e),n}return o(e,t),e.DIST_SURFACE2=4e4,e}(i.a);e.a=c},function(t,e,n){"use strict";function a(){var t=Date.now(),e=t-p,n=!0;E||g.a.update(),e>m&&(E?(f.b.setGlobalAlpha(S),S>0?S-=v:(S=1,n=!1)):(b.x=Math.cos(O)*_,b.y=Math.sin(O)*_,O+=T,f.b.centerOn(b),y.a.process(b)),f.b.render(),p=t-e%m),n?l=requestAnimationFrame(a):c()}function i(){this.alpha=.5,Object(d.b)("switch-flick")}function o(){this.alpha=1}function r(t){var e=t.filename,n=t.onClick,a=t.dy,r=h.Sprite.fromImage(e);if(r.anchor.set(.5),r.y=innerHeight>>1+a,n){var c=function(){Object(d.b)("heavy-switch"),n()};r.buttonMode=!0,r.interactive=!0,r.on("mouseover",i),r.on("mouseout",o),r.on("tap",c),r.on("click",c)}return r}function c(){cancelAnimationFrame(l),f.b.removeAllChildren(),u&&u()}function s(){R=Math.max(Math.min(R,A.length-1),1),F.forEach(function(t,e){e===R?i.call(F[R]):o.bind(t)()})}var l,p,u,h=n(18),f=(n.n(h),n(22)),y=n(70),d=n(23),g=n(307),m=1e3/60,b={x:0,y:0},_=600,O=0,T=Math.PI/180*.02,S=1,v=.02,E=!1,A=[{filename:"assets/title.png",dy:-200},{filename:"assets/new-game.png",dy:-50,onClick:function(){F.forEach(function(t){t.off("tap"),t.off("click"),t.off("mouseout"),t.off("mouseover")}),E=!0}},{filename:"assets/how-to-play.png",dy:50,onClick:function(){return window.open("how-to-play.html","_blank")}},{filename:"assets/about.png",dy:150,onClick:function(){return window.open("http://github.com/jsyang/celestial","_blank")}}],F=[],P=function(){F.forEach(function(t,e){t.x=innerWidth/2,t.y=innerHeight/2+A[e].dy})},R=0;e.a={setFadeOutCallback:function(t){u=t},prevButton:function(){R--,s()},nextButton:function(){R++,s()},clickButton:function(){A[R].onClick(),Object(d.b)("heavy-switch")},start:function(){f.b.init(),y.a.init().forEach(f.b.addChild),(F=A.map(r)).forEach(f.b.addChildToHUD),addEventListener("resize",P),P(),p=Date.now(),a()},stop:c}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){var e=n(159),a=n(128),i=n(308);window.addEventListener("DOMContentLoaded",function(){a.a.setFadeOutCallback(function(){e.a.init(),e.a.start()}),i.a.load().then(a.a.start)});var o=t;o&&o.hot&&o.hot.accept()}.call(e,n(158)(t))},,function(t,e,n){"use strict";function a(){var t=Date.now(),e=t-o;if(Object(d.a)(),l.a.processGameScreen(),u.a.updateAll(),Object(y.a)(),h.a.update(),f.a.update(),u.a.prepareNext(),e>m){b&&(_<1?_+=O:(_=1,b=!1),c.b.setGlobalAlpha(_));var n=s.a.getFocus();n&&(f.a.setOrigin(n),c.b.centerOn(n)),r.a.process(n),c.b.render(),o=t-e%m}i=requestAnimationFrame(a)}var i,o,r=n(70),c=n(22),s=n(60),l=n(61),p=n(264),u=n(4),h=n(303),f=n(304),y=n(305),d=n(306),g=n(123),m=1e3/60,b=!0,_=0,O=.02;e.a={init:function(){b=!0,_=0,c.b.init(),g.a.init(),r.a.init().forEach(c.b.addChild),p.a.init(),f.a.init(),h.a.init()},start:function(){o=Date.now(),a()},stop:function(){cancelAnimationFrame(i)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var a=this&&this.__assign||Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},i=1e-6,o=function(t){var e=t.left,n=t.right,a=(t.up,t.analogAngle),i=t.button0,o=t.button1,r=t.button2,c=t.button3;return{TURN_LEFT:Boolean(e),TURN_RIGHT:Boolean(n),ACCELERATE:Boolean(r),SHOOT_SPECIAL:Boolean(o),SHOOT:Boolean(i),RESTART_GAME:Boolean(o&&c),analogAngle:a}},r={left:!1,right:!1,up:!1,analogAngle:0,button0:!1,button1:!1,button2:!1,button3:!1};e.a={getEvents:function(t){void 0===t&&(t=0);var e=navigator.getGamepads()[t];if(e){var n=e.axes,a=n[0],c=n[1],s=Math.abs(a)>.1,l=Math.abs(c)>.1,p=void 0;(s||l)&&(s||(a=a>0?i:-i),l||(c=c>0?i:-i),p=Math.atan2(c,a)),r={left:e.axes[0]<-.1,right:e.axes[0]>.1,up:e.axes[1]<-.1,analogAngle:p,button0:e.buttons[0].pressed,button1:e.buttons[1].pressed,button2:e.buttons[2].pressed,button3:e.buttons[3].pressed}}return o(r)},getInputState:function(){return a({},r)}}},function(t,e,n){"use strict";function a(t){c[r[t.which]]=!1}function i(t){c[r[t.which]]=!0}var o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},r={37:"left_arrow",38:"up_arrow",39:"right_arrow",40:"down_arrow",69:"e",70:"f",82:"r"},c={left_arrow:!1,right_arrow:!1,up_arrow:!1,down_arrow:!1,e:!1,f:!1,r:!1};window&&(window.addEventListener("keydown",i),window.addEventListener("keyup",a)),e.a={getEvents:function(){return{SHOOT_SPECIAL:Boolean(c.e),TURN_LEFT:Boolean(c.left_arrow),TURN_RIGHT:Boolean(c.right_arrow),ACCELERATE:Boolean(c.up_arrow),SHOOT:Boolean(c.f),RESTART_GAME:Boolean(c.r)}},getInputState:function(){return o({},c)}}},function(t,e,n){"use strict";e.a=function(t,e){var n=t.isDockedPlanet;n||("number"==typeof e.analogAngle?t.rotation=e.analogAngle:e.TURN_LEFT?t.rotation-=a:e.TURN_RIGHT&&(t.rotation+=a),t.isShooting=e.SHOOT),t.isShooting=e.SHOOT,e.ACCELERATE?(n&&t.undockPlanet(),t.flameOn(),t.accelerate(i)):t.flameOff()};var a=.05,i=.2},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),e.a=function(t){return(t.up_arrow||t.up)&&(a.y-=i),(t.down_arrow||t.down)&&(a.y+=i),(t.left_arrow||t.left)&&(a.x-=i),(t.right_arrow||t.right)&&(a.x+=i),a};var a={x:0,y:0},i=40,o=function(t){var e=t.x,n=t.y;return a={x:e,y:n}}},function(t,e,n){"use strict";var a=n(60),i=n(61),o=n(4),r=n(11),c=n(15),s=n(33),l=n(301),p=n(302),u=["BLUE","GREEN","RED","YELLOW"];e.a={init:function(){for(var t=c.a.int(2,5),e=0;e<t;e++){var n=Object(l.a)(),h=u.pop();h&&Object(p.a)(h,n)}var f=o.a.create("Fighter",{x:c.a.int(0,s.a),y:c.a.int(0,s.a),rotation:c.a.float(-Math.PI,Math.PI),team:r.a.MAGENTA});o.a.create("Freighter",{x:f.x+c.a.int(-100,100),y:f.y+c.a.int(-100,100),target:f,team:r.a.MAGENTA,isOrbitingPlanet:!1,materialsFinished:500}),o.a.create("Freighter",{x:f.x+c.a.int(-100,100),y:f.y+c.a.int(-100,100),target:f,team:r.a.MAGENTA,isOrbitingPlanet:!1,materialsFinished:500}),a.a.setFocus(f),i.a.setControlledEntity(f)}}},function(t,e,n){"use strict";var a=n(4),i=n(266),o=n(267),r=n(268),c=n(269),s=n(270),l=n(271),p=n(272),u=n(273),h=n(274),f=n(275),y=n(276),d=n(277),g=n(278),m=n(279),b=n(280),_=n(125),O=n(281),T=n(283),S=n(284),v=n(285),E=n(286),A=n(124),F=n(287),P=[g.a,m.a,s.a,l.a,b.a,_.a,S.a,v.a,A.a,i.a,O.a,u.a,p.a,r.a,h.a,f.a,y.a,o.a,T.a,F.a,c.a,E.a,d.a];e.a={init:function(t){P.forEach(function(e){e.DEFAULTS&&t[e.componentFlag]&&Object.keys(e.DEFAULTS).forEach(function(n){void 0===t[n]&&(t[n]=e.DEFAULTS[n])})})},update:function(t){t.hp>0?P.forEach(function(e){t[e.componentFlag]&&e.process&&e.process(t)}):t[d.a.componentFlag]&&d.a.process(t),t.hp>0?a.a.commit(t):a.a.destroy(t)}}},function(t,e,n){"use strict";var a=n(4);e.a={componentFlag:"canAutoTargetEnemy",DEFAULTS:{AUTO_TARGET_ENEMY_TIME:1500,autoTargetSearchDist2:16e4,autoTargetLastSearchTime:0},process:function(t){if(t.canShootCannon){var e=Date.now();e-t.autoTargetLastSearchTime>=t.AUTO_TARGET_ENEMY_TIME&&(function(t){t.cannonTarget=a.a.getNearestEnemyTarget(t,t.autoTargetSearchDist2),t.isShooting=Boolean(t.cannonTarget)}(t),t.autoTargetLastSearchTime=e)}}}},function(t,e,n){"use strict";var a=n(15),i=n(4),o=n(124),r=n(125),c={PRODUCT:{Freighter:{cost:300,time:120},Fighter:{cost:500,time:90}},orderManufacture:function(t){this.isManufacturing=!0,this.manufactureTime=this.PRODUCT[t].time,this.manufactureType=t},isManufacturing:!1,manufactureTime:0,manufactureType:void 0};e.a={componentFlag:"canManufacture",DEFAULTS:c,process:function(t){if(t.isManufacturing&&t.planet.pbase&&t.planet.pbase.materialsFinished>=t.PRODUCT[t.manufactureType].cost)if(t.manufactureTime>0)t.manufactureTime--;else{var e={x:t.x+a.a.float(-1,1),y:t.y+a.a.float(-1,1),team:t.team},n=i.a.create(t.manufactureType,e);"Fighter"===t.manufactureType?(t.type,o.a.DEFAULTS.dockPlanet.call(n,t.planet)):"Freighter"===t.manufactureType&&r.a.DEFAULTS.enterPlanetOrbit.call(n,t.planet),t.isManufacturing=!1,t.manufactureType=void 0}}}},function(t,e,n){"use strict";e.a={componentFlag:"canMine",DEFAULTS:{MINE_RATE:25,MINE_TIME:20,mineTime:20},process:function(t){t.mineTime>0?t.mineTime--:(t.mineTime=t.MINE_TIME,t.planet.materialsRaw+=t.MINE_RATE)}}},function(t,e,n){"use strict";e.a={componentFlag:"canMetabolize",process:function(t){t.hp--}}},function(t,e,n){"use strict";var a=n(33);e.a={componentFlag:"canMoveLinearly",DEFAULTS:{dx:0,dy:0},process:function(t){t.isDockedPlanet||(t.x+=t.dx,t.y+=t.dy,0!==t.x&&t.x!==a.a||(t.dx=0),0!==t.y&&t.y!==a.a||(t.dy=0))}}},function(t,e,n){"use strict";var a=n(4),i={TURN_RATE:.07,SPEED:2.5,DIST_HALT2:Math.pow(80,2)},o=Math.pow(200,2);e.a={componentFlag:"canMoveToTarget",DEFAULTS:i,process:function(t){var e=t.target,n=t.DIST_HALT2;if(e&&e.hp>0){var i=a.a.getDistSquared(t,e);if("Planet"===e.type&&(n=o),i>n){var r=function(t,e){var n=t.rotation,i=a.a.getAngleFromTo(t,e),o=Math.abs(i-n);return o>Math.PI?n>0?t.rotation+=t.TURN_RATE:t.rotation-=t.TURN_RATE:o>t.TURN_RATE?n>i?t.rotation-=t.TURN_RATE:t.rotation+=t.TURN_RATE:t.rotation=i,n=t.rotation}(t,e);t.x+=Math.cos(r)*t.SPEED,t.y+=Math.sin(r)*t.SPEED,t.flameOn&&t.flameOn()}else"Planet"===e.type&&t.canOrbitPlanet&&t.enterPlanetOrbit(e),t.flameOff&&t.flameOff()}else t.target=null}}},function(t,e,n){"use strict";e.a={componentFlag:"canHarvest",DEFAULTS:{HARVEST_RATE_RAW:35,HARVEST_RATE_FINISHED:25,HARVEST_TIME:10,harvestTime:0},process:function(t){t.harvestTime>0?t.harvestTime--:(t.harvestTime=t.HARVEST_TIME,t.planet.materialsRaw>0&&t.materialsRaw<t.MAX_RAW_MATERIALS&&(t.MAX_RAW_MATERIALS-t.materialsRaw<t.HARVEST_RATE_RAW?(t.planet.materialsRaw=0,t.materialsRaw+=t.MAX_RAW_MATERIALS-t.materialsRaw):(t.planet.materialsRaw-=t.HARVEST_RATE_RAW,t.materialsRaw+=t.HARVEST_RATE_RAW)),t.planet.materialsFinished>0&&t.materialsFinished<t.MAX_FINISHED_MATERIALS&&(t.MAX_FINISHED_MATERIALS-t.materialsFinished<t.HARVEST_RATE_FINISHED?(t.planet.materialsFinished=0,t.materialsFinished+=t.MAX_FINISHED_MATERIALS-t.materialsFinished):(t.planet.materialsFinished-=t.HARVEST_RATE_FINISHED,t.materialsFinished+=t.HARVEST_RATE_FINISHED)))}}},function(t,e,n){"use strict";e.a={componentFlag:"canStoreMaterial",DEFAULTS:{MAX_RAW_MATERIALS:3e3,MAX_FINISHED_MATERIALS:2e3,materialsRaw:0,materialsFinished:0},process:function(){}}},function(t,e,n){"use strict";e.a={componentFlag:"canRepair",DEFAULTS:{REPAIR_COST_FINISHED:25,REPAIR_TIME:30,repairTime:0},process:function(t){t.hp<t.maxHp&&t.materialsFinished>t.REPAIR_COST_FINISHED&&t.materialsFinished>0&&(t.repairTime>0?t.repairTime--:(t.hp++,t.materialsFinished-=t.REPAIR_COST_FINISHED,t.repairTime=t.REPAIR_TIME))}}},function(t,e,n){"use strict";e.a={componentFlag:"canRefine",DEFAULTS:{REFINE_RATE_RAW_TO_FINISHED:.5},process:function(t){t.materialsFinished<t.MAX_FINISHED_MATERIALS?t.materialsRaw>0&&(t.materialsFinished+=t.REFINE_RATE_RAW_TO_FINISHED,t.materialsFinished>t.MAX_FINISHED_MATERIALS&&(t.planet.materialsFinished+=t.materialsFinished-t.MAX_FINISHED_MATERIALS,t.materialsFinished=t.MAX_FINISHED_MATERIALS),t.materialsRaw--):t.materialsRaw>0&&(t.planet.materialsFinished+=t.REFINE_RATE_RAW_TO_FINISHED,t.materialsRaw--)}}},function(t,e,n){"use strict";var a=n(4),i=[{type:"PLab",cost:200},{type:"PComm",cost:300},{type:"SpacePort",cost:1e3,prerequisite:"PColony"},{type:"SpaceDock",cost:500,prerequisite:"SpacePort",occupation:"SpacePort"},{type:"SensorArray",cost:500,prerequisite:"SpacePort",occupation:"SpacePort"}];e.a={componentFlag:"canConstruct",DEFAULTS:{CONSTRUCTION_TIME:3e3,constructionTime:3e3},process:function(t){t.materialsFinished>0&&(t.constructionTime>0?t.constructionTime--:(i.forEach(function(t){var e=this.team,n=this.planet,i=t.type.toLowerCase(),o=!0;t.prerequisite&&(o=Boolean(this.planet[t.prerequisite.toLowerCase()])),!this.planet[i]&&this.materialsFinished>=t.cost&&o&&("SpacePort"===t.occupation?this.planet[i]=a.a.create(t.type,{spaceport:this.planet.spaceport,planet:n,team:e}):this.planet[i]=a.a.create(t.type,{planet:n,team:e}),this.materialsFinished-=t.cost)}.bind(t)),t.constructionTime=t.CONSTRUCTION_TIME))}}},function(t,e,n){"use strict";function a(){var t=this.EXPLOSION_SOUND,e=this.EXPLOSION_FRAGMENTS,n=this.x,a=this.y,c=this.dx,s=this.dy,l=this.explosionOriginDx,p=this.explosionOriginDy;Object(i.b)(t);for(var u=e;u>0;u--)o.a.create("Shot",{shotType:"cannon_normal",x:l+n+r.a.float(-10,10),y:p+a+r.a.float(-10,10),team:o.a.TEAM.NONE,dx:r.a.float(-2,2)+(c||0),dy:r.a.float(-2,2)+(s||0)});this.hasExploded=!0}var i=n(23),o=n(4),r=n(15),c={explosionOriginDx:0,explosionOriginDy:0,EXPLOSION_FRAGMENTS:6,EXPLOSION_SOUND:"collide",hasExploded:!1,explode:a};e.a={componentFlag:"canExplode",DEFAULTS:c,process:function(t){var e=t.hasExploded,n=t.canExplode;t.hp<=0&&!e&&n&&a.call(t)}}},function(t,e,n){"use strict";e.a={componentFlag:"canOccupyPlanet",process:function(t){t.x=t.planet.x,t.y=t.planet.y}}},function(t,e,n){"use strict";var a=n(4);e.a={componentFlag:"canOccupySpacePort",process:function(t){var e=t.spaceport,n=e.x,i=e.y,o=e.rotation;e.hp>0?(t.x=n,t.y=i,t.rotation=o):(t.explode&&t.explode(),a.a.destroy(t))}}},function(t,e,n){"use strict";e.a={componentFlag:"canOrbitStar",DEFAULTS:{D_ROTATION:1e-4,orbitDistance:1800,orbitRotation:0},process:function(t){t.orbitRotation+=t.D_ROTATION,t.x=Math.cos(t.orbitRotation)*t.orbitDistance+t.star.x,t.y=Math.sin(t.orbitRotation)*t.orbitDistance+t.star.y}}},function(t,e,n){"use strict";var a=n(23),i=n(4),o=n(8);e.a={componentFlag:"canDamage",DEFAULTS:{damageHp:1},process:function(t){i.a.getNearest(t).some(function(t){return!(t.team===this.team||"Planet"===t.type||"Star"===t.type||!Object(o.b)(this,t)||(Object(a.b)(t.AUDIO_HIT||"hit"),t.hp-=this.damageHp,t.hitTime=10,i.a.destroy(this),0))}.bind(t))}}},,function(t,e,n){"use strict";function a(t){var e,n=this.cannonTarget,a=this.cannonShotSpeed,r=t(this);if(this.cannonMatchShooterRotation)e=this.rotation;else{var s=n.dx||0,l=n.dy||0,p={x:n.x+5*s*a,y:n.y+5*l*a};e=o.a.getAngleFromTo({x:r.x+this.x,y:r.y+this.y},p),e+=i.a.float(-.15,.15)}var u=Math.cos(e)*a,h=Math.sin(e)*a,f=this.dx||0,y=this.dy||0,d=this.cannonShotType,g={shotType:d,x:r.x+this.x-f,y:r.y+this.y-y,team:this.team,dx:u+f,dy:h+y};"pbase_plasma"===d?(g.rotation=e,g.shotType="plasma"):"plasma"===d&&(g=c({},g,{rotation:this.rotation,dx:10*Math.cos(this.rotation)+this.dx,dy:10*Math.sin(this.rotation)+this.dy})),o.a.create("Shot",g)}var i=n(15),o=n(4),r=n(23),c=this&&this.__assign||Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},s={plasma:"fire",pbase_plasma:"laser",cannon_heavy:"fire-heavy",cannon_normal:"fire"},l={cannonGetMuzzleFuncs:[],CANNON_REARM_TIME:40,CANNON_LOAD_TIME_MS:100,cannonRearmTime:40,cannonLastShotTime:0,cannonMatchShooterRotation:!0,cannonTarget:void 0,cannonShotSpeed:4,cannonShotType:"cannon_normal",isShooting:!1,isRearming:!1,cannonAmmo:1/0,cannonMaxAmmo:1/0,shoot:a};e.a={componentFlag:"canShootCannon",DEFAULTS:l,process:function(t){var e=t.isShooting,n=t.cannonAmmo,i=t.cannonMaxAmmo,o=t.CANNON_REARM_TIME;if(e){var c=Date.now();n>0?c-t.cannonLastShotTime>=t.CANNON_LOAD_TIME_MS&&(t.cannonGetMuzzleFuncs.forEach(a.bind(t)),Object(r.b)(s[t.cannonShotType]),t.cannonLastShotTime=c,t.cannonAmmo--):t.cannonRearmTime>0?t.cannonRearmTime--:(t.cannonAmmo=i,t.cannonRearmTime=o)}}}},function(t,e,n){"use strict";e.a={componentFlag:"canLimitSpeed",DEFAULTS:{MAX_SPEED:40,MAX_SPEED2:1600},process:function(t){var e=Math.pow(t.dx,2)+Math.pow(t.dy,2);if(e>t.MAX_SPEED2){var n=t.MAX_SPEED*Math.pow(e,-.5);t.dx*=n,t.dy*=n}}}},function(t,e,n){"use strict";var a={accelerate:function(t){this.dx+=Math.cos(this.rotation)*t,this.dy+=Math.sin(this.rotation)*t}};e.a={componentFlag:"canAccelerate",DEFAULTS:a}},function(t,e,n){"use strict";e.a={componentFlag:"canDisplayHit",DEFAULTS:{hitTime:-1},process:function(t){t.renderHit&&t.renderHit()}}},function(t,e,n){"use strict";var a=n(4),i=n(23),o={TIME_OFFLOAD_SUPPLY:200,MAX_MATERIALS_FINISHED:500,createPBase:function(){var t=this.planet;Object(i.b)("nav"),t.pbase=a.a.create("PBase",{x:t.x,y:t.y,planet:t,team:this.team}),this.canExplode=!1,a.a.destroy(this)},createPColony:function(){var t=this.planet;Object(i.b)("nav"),t.pcolony=a.a.create("PColony",{x:t.x,y:t.y,planet:t,team:this.team}),this.canExplode=!1,a.a.destroy(this)},loadOrDumpSupply:function(){var t=this.planet.pbase;if(0===t.materialsFinished){t.materialsFinished+=this.materialsFinished,this.materialsFinished=0;var e=0;t.materialsFinished>t.MAX_FINISHED_MATERIALS?(e=t.materialsFinished-t.MAX_FINISHED_MATERIALS,t.materialsFinished=t.MAX_MATERIALS_FINISHED,this.materialsFinished=e,this.unloadSupply()):a.a.destroy(this)}else if(this.planet.materialsFinished>0&&this.materialsFinished<this.MAX_MATERIALS_FINISHED){var n=this.MAX_MATERIALS_FINISHED-this.materialsFinished;n>=this.planet.materialsFinished?(this.materialsFinished+=this.planet.materialsFinished,this.planet.materialsFinished=0):(this.materialsFinished+=n,this.planet.materialsFinished-=n),this.loadSupply()}}};e.a={componentFlag:"canColonizePlanet",DEFAULTS:o,process:function(t){t.canOrbitPlanet&&t.isOrbitingPlanet&&t.materialsFinished>0&&(void 0===t.supplyTime?t.supplyTime=t.TIME_OFFLOAD_SUPPLY:t.supplyTime>0?t.supplyTime--:0===t.supplyTime&&(t.planet.pbase?t.planet.pcolony?t.loadOrDumpSupply():t.createPColony():t.createPBase()))}}},function(t,e,n){"use strict";var a=n(22),i=n(4),o={},r=function(t){return o[t]||[]};e.a={add:function(t){var e=t.type;o[e]?o[e].push(t):o[e]=[t],a.b.addChild(t.geo.graphics)},remove:function(t){t.hp=0;var e=t.type.toLowerCase();t.planet&&delete t.planet[e],t.spaceport&&delete t.spaceport[e],delete t.target;var n=r(t.type),i=n.indexOf(t);-1!==i&&n.splice(i,1),a.b.removeChild(t.geo.graphics)},getByType:r,getAbsoluteNearestByType:function(t,e){var n,a=1/0,o=r(e);return o&&o.forEach(function(e){var o=Object(i.b)(t,e);o<a&&(a=o,n=e)}),n}}},function(t,e,n){"use strict";function a(t,e,n){var a=t.x>>r,i=t.y>>r;return a+=e||0,i+=n||0,a+i*c}function i(t){return[].concat(s[a(t,-1,-1)],s[a(t,0,-1)],s[a(t,1,-1)],s[a(t,-1,0)],s[a(t,0,0)],s[a(t,1,0)],s[a(t,0,1)],s[a(t,-1,1)],s[a(t,1,1)]).filter(Boolean)}var o=n(4),r=9,c=n(33).a>>r,s=[],l=[],p={Freighter:!0,Fighter:!0,PBase:!0,PColony:!0,PComm:!0,PLab:!0,Probe:!0,SensorArray:!0,SpaceDock:!0,SpacePort:!0},u=function(t){return t.type in p};e.a={prepareNext:function(){s=l,l=[]},commit:function(t){if(t.hp>0){var e=a(t,0,0);l[e]instanceof Array?l[e].push(t):l[e]=[t]}return this},getNearest:function(t,e,n){var a=i(t);return(e||n)&&(a=a.filter(function(t,e,n){var a=!0;return e>0&&(a=a&&Object(o.b)(this,n)<=e),t&&(a=a&&n.type===t),a}.bind(t,e,n))),a},getNearestEnemyTarget:function(t,e){var n,a=i(t).filter(function(e){return e.team!==t.team&&u(e)}),r=1/0;return a&&a.forEach(function(a){var i=Object(o.b)(t,a);i<=e&&i<r&&(r=i,n=a)}),n}}},function(t,e,n){"use strict";var a=n(8),i=n(7),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r={body:{type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[-2,2,-4,0,-2,-2,-4,-4,-4,-6,2,-4,0,-2,8,0,0,2,2,4,-4,6,-4,4,-2,2],collisionPath:[-4,-6,8,0,-4,6]},flame1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-4,-4,-8,-5,-4,-6]},flame2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-4,4,-8,5,-4,6]}},c=function(t){function e(e){var n=t.call(this)||this;return n.type="Fighter",n.geo=Object(a.a)(r.body,{collisionPath:r.body.collisionPath}),n.mass=10,n.hp=4,n.maxHp=4,n.dx=0,n.dy=0,n.rotation=0,n.canExplode=!0,n.cannonGetMuzzleFuncs=[function(t){return t.geo.collider.calcPoints[1]}],n.canLimitSpeed=!0,n.canMoveLinearly=!0,n.canAccelerate=!0,n.canDockPlanet=!0,n.canShootCannon=!0,n.flameOn=function(){n.setChildVisible(0,!0),n.setChildVisible(1,!0)},n.flameOff=function(){n.setChildVisible(0,!1),n.setChildVisible(1,!1)},Object.assign(n,e),n.assignTeamColor(),n.geo.graphics.addChild(Object(a.a)(r.flame1).graphics,Object(a.a)(r.flame2).graphics),n.flameOff(),n}return o(e,t),e}(i.a);e.a=c},function(t,e,n){"use strict";var a=n(8),i=n(7),o=n(11),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c={body:{type:"polygon",lineStyle:{width:1,color:15658734,alpha:1},collisionPath:[-44,-4,-38,-8,26,-10,44,0,26,10,-38,8,-44,4],path:[-26,-2,-26,-8,-38,-8,-38,2,-44,4,-44,-4,-38,-2,-38,8,-26,8,-26,-2,24,-2,26,-10,44,0,26,10,24,2,-26,2]},cargopodL:{type:"polygon",lineStyle:{width:1,color:15658734,alpha:1},path:[-24,-2,-24,-12,22,-12,22,-2]},cargopodR:{type:"polygon",lineStyle:{width:1,color:15658734,alpha:1},path:[-24,2,-24,12,22,12,22,2]},flag:{type:"polygon",lineStyle:{width:2,color:255,alpha:1},path:[34,0,42,0]},turret1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[-34,0,-30,-3,-30,3,-34,0]},turret2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[28,-3,32,0,28,3,28,-2]},flame:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-44,-2,-50,0,-44,2]}},s=function(t){function e(e){var n=t.call(this)||this;n.type="Freighter",n.geo=Object(a.a)(c.body),n.hp=10,n.maxHp=10,n.canDisplayHit=!0,n.canOrbitPlanet=!0,n.isOrbitingPlanet=!1,n.orbitDistance=205,n.canExplode=!0,n.canColonizePlanet=!0,n.canMoveToTarget=!0,n.canStoreMaterial=!0,n.materialsRaw=0,n.materialsFinished=0,n.loadSupply=function(){n.setChildVisible(2,!0),n.setChildVisible(3,!0)},n.unloadSupply=function(){n.setChildVisible(2,!1),n.setChildVisible(3,!1)},n.flameOn=function(){return n.setChildVisible(0,!0)},n.flameOff=function(){return n.setChildVisible(0,!1)},Object.assign(n,e);var i=Object(a.a)(c.cargopodL),o=Object(a.a)(c.cargopodR),r=Object(a.a)(c.turret1),s=Object(a.a)(c.turret2),l=Object(a.a)(c.flag),p=Object(a.a)(c.flame);return n.geo.graphics.addChild(p.graphics,l.graphics,i.graphics,o.graphics,r.graphics,s.graphics),n.assignTeamColor(),n.flameOff(),n}return r(e,t),e.prototype.assignTeamColor=function(){this.getChildAt(1).currentPath.lineColor=o.a._COLORS[this.team]},e}(i.a);e.a=s},function(t,e,n){"use strict";var a=n(11),i=n(8),o=n(7),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c={_name:"Planetary Base",body:{type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[-20,20,-20,-20,20,-20,20,20,-20,20]},turret1:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[65,-60,65,-65,60,-65,65,-60]},turret2:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[-65,-60,-65,-65,-60,-65,-65,-60]},turret3:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[65,60,65,65,60,65,65,60]},turret4:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[-65,60,-65,65,-60,65,-65,60]}},s=[function(){return{x:65,y:65}},function(){return{x:65,y:-65}},function(){return{x:-65,y:-65}},function(){return{x:-65,y:65}}],l=function(t){function e(e){var n=t.call(this)||this;return n.type="PBase",n.geo=Object(i.a)(c.body),n.hp=20,n.maxHp=20,n.canDisplayHit=!0,n.canExplode=!0,n.canHarvest=!0,n.canRepair=!0,n.canRefine=!0,n.canConstruct=!0,n.canOccupyPlanet=!0,n.canStoreMaterial=!0,n.materialsRaw=0,n.materialsFinished=0,n.canAutoTargetEnemy=!0,n.autoTargetSearchDist2=36e4,n.canShootCannon=!0,n.cannonShotType="pbase_plasma",n.CANNON_LOAD_TIME_MS=100,n.cannonMatchShooterRotation=!1,n.cannonShotSpeed=8,n.cannonAmmo=10,n.cannonMaxAmmo=10,n.cannonGetMuzzleFuncs=s,Object.assign(n,e),n.geo.graphics.currentPath.lineColor=a.a._COLORS[n.team],n.geo.graphics.addChild(Object(i.a)(c.turret1).graphics,Object(i.a)(c.turret2).graphics,Object(i.a)(c.turret3).graphics,Object(i.a)(c.turret4).graphics),n}return r(e,t),e}(o.a);e.a=l},function(t,e,n){"use strict";var a=n(11),i=n(8),o=n(7),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c={type:"polygon",_name:"Planetary Colony",lineStyle:{width:1,color:255,alpha:1},path:[-30,40,-70,40,-70,-40,-30,-40,-30,40]},s=function(t){function e(e){var n=t.call(this)||this;return n.type="PColony",n.geo=Object(i.a)(c),n.hp=15,n.maxHp=15,n.canDisplayHit=!0,n.canMine=!0,n.canExplode=!0,n.explosionOriginDx=-50,n.explosionOriginDy=0,n.canOccupyPlanet=!0,n.canRepair=!0,n.REPAIR_COST_FINISHED=10,n.REPAIR_TIME=20,Object.assign(n,e),n.geo.graphics.currentPath.lineColor=a.a._COLORS[n.team],n}return r(e,t),e}(o.a);e.a=s},function(t,e,n){"use strict";var a=n(11),i=n(8),o=n(7),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c={type:"polygon",_name:"Planetary Communications Center",lineStyle:{width:1,color:255,alpha:1},path:[40,30,0,30,0,50,40,50,40,30,60,35,30,10,40,30]},s=function(t){function e(e){var n=t.call(this)||this;return n.type="PComm",n.geo=Object(i.a)(c),n.team=a.a.NONE,n.hp=7,n.maxHp=7,n.canDisplayHit=!0,n.canExplode=!0,n.explosionOriginDx=31,n.explosionOriginDy=33,n.canRepair=!0,n.canOccupyPlanet=!0,n.REPAIR_COST_FINISHED=2,n.REPAIR_TIME=10,Object.assign(n,e),n.geo.graphics.currentPath.lineColor=a.a._COLORS[n.team],n}return r(e,t),e}(o.a);e.a=s},function(t,e,n){"use strict";var a=n(11),i=n(8),o=n(7),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c={type:"polygon",_name:"Planetary Lab",lineStyle:{width:1,color:255,alpha:1},path:[0,-40,0,-70,50,-70,50,-40,0,-40]},s=function(t){function e(e){var n=t.call(this)||this;return n.type="PLab",n.geo=Object(i.a)(c),n.team=a.a.NONE,n.hp=10,n.maxHp=10,n.canDisplayHit=!0,n.canExplode=!0,n.explosionOriginDx=20,n.explosionOriginDy=-52,n.canOccupyPlanet=!0,n.canManufacture=!0,n.PRODUCT={Freighter:{cost:300,time:120},Fighter:{cost:500,time:90}},Object.assign(n,e),n.geo.graphics.currentPath.lineColor=a.a._COLORS[n.team],n}return r(e,t),e}(o.a);e.a=s},function(t,e,n){"use strict";var a=n(8),i=n(7),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r={body:{type:"polygon",lineStyle:{width:1,color:16711935,alpha:1},path:[-4,1,0,2,4,0,0,-2,-4,-1,-4,1],collisionPath:[-4,2,0,4,8,0,0,-4,-4,-2]},flame:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-4,-4,-8,-5,-4,-6]}},c=function(t){function e(e){var n=t.call(this)||this;return n.type="Probe",n.geo=Object(a.a)(r.body,{collisionPath:r.body.collisionPath}),n.AUDIO_HIT="hit2",n.hp=2,n.maxHp=2,n.hasDied=!1,n.hitTime=-1,n.patrolIndex=0,n.rotation=0,n.flameOn=function(){return n.setChildVisible(0,!0)},n.flameOff=function(){return n.setChildVisible(0,!1)},Object.assign(n,e),n.assignTeamColor(),n.geo.graphics.addChild(Object(a.a)(r.flame).graphics),n.flameOff(),n}return o(e,t),e}(i.a);e.a=c},function(t,e,n){"use strict";var a=n(8),i=n(7),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r={_name:"Orbital Sensor Array",type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[6,26,12,28,12,40,18,46,18,34,12,40,6,42]},c=function(t){function e(e){var n=t.call(this)||this;return n.type="SensorArray",n.geo=Object(a.a)(r),n.hp=5,n.maxHp=5,n.canExplode=!0,n.canDisplayHit=!0,n.canRepair=!0,n.canOccupySpacePort=!0,Object.assign(n,e),n.assignTeamColor(),n}return o(e,t),e}(i.a);e.a=c},function(t,e,n){"use strict";var a=n(11),i=n(8),o=n(7),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c={plasma:{type:"polygon",lineStyle:{width:1,color:16711680,alpha:.6},path:[8,0,-8,0]},cannon_normal:{type:"polygon",fill:{color:16777215,alpha:1},path:[-1,1,1,1,1,-1,-1,-1,-1,1]},cannon_heavy:{type:"polygon",lineStyle:{width:2,color:65535,alpha:1},path:[-3,0,0,0,0,-3,0,0,0,3,0,0,3,0]}},s={plasma:.25,cannon_heavy:2,cannon_normal:1},l=function(t){function e(e){var n=t.call(this)||this;n.type="Shot",n.canMoveLinearly=!0,n.canDamage=!0,n.canMetabolize=!0,n.shotType="cannon_normal",n.team=a.a.NONE,n.hp=60,n.damageHp=1;var o=e.shotType;return n.geo=Object(i.a)(c[o]),n.damageHp=s[o],Object.assign(n,e),n}return r(e,t),e}(o.a);e.a=l},function(t,e,n){"use strict";var a=n(8),i=n(7),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r={_name:"Space Dock",type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[6,-42,20,-42,20,-22,14,-26,6,-26]},c=function(t){function e(e){var n=t.call(this)||this;return n.type="SpaceDock",n.geo=Object(a.a)(r),n.hp=8,n.maxHp=8,n.canExplode=!0,n.canDisplayHit=!0,n.canRepair=!0,n.canManufacture=!0,n.PRODUCT={Fighter:{cost:200,time:60},Probe:{cost:15,time:10}},n.canOccupySpacePort=!0,Object.assign(n,e),n.assignTeamColor(),n}return o(e,t),e}(i.a);e.a=c},function(t,e,n){"use strict";var a=n(8),i=n(7),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r={_name:"Space Port",body:{type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[-2,0,-6,-20,-6,-36,-2,-44,6,-44,6,-24,2,-20,2,20,6,24,6,44,-2,44,-6,36,-6,20,-2,0]},turret1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[0,28,4,26,4,30,0,28]},turret2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[0,-28,4,-26,4,-30,0,-28]},turret3:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[4,44,2,48,0,44]},turret4:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[4,-44,2,-48,0,-44]},flame1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,20,-12,22,-6,24]},flame2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,-24,-12,-22,-6,-20]},flame3:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,32,-12,34,-6,36]},flame4:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,-36,-12,-34,-6,-32]}},c=function(t){function e(e){var n=t.call(this)||this;return n.type="SpacePort",n.geo=Object(a.a)(r.body),n.hp=30,n.maxHp=30,n.canRepair=!0,n.canRefine=!0,n.canOrbitPlanet=!0,n.orbitDistance=205,n.canDisplayHit=!0,n.canExplode=!0,n.EXPLOSION_FRAGMENTS=12,n.canStoreMaterial=!0,n.materialsRaw=0,n.materialsFinished=0,Object.assign(n,e),n.assignTeamColor(),n.geo.graphics.addChild(Object(a.a)(r.flame1).graphics,Object(a.a)(r.flame2).graphics,Object(a.a)(r.flame3).graphics,Object(a.a)(r.flame4).graphics,Object(a.a)(r.turret1).graphics,Object(a.a)(r.turret2).graphics,Object(a.a)(r.turret3).graphics,Object(a.a)(r.turret4).graphics),n}return o(e,t),e}(i.a);e.a=c},function(t,e,n){"use strict";function a(){return{x:r.a.float(p,c.a-p),y:r.a.float(p,c.a-p)}}function i(t){for(var e=o.a.getByType("Star"),n=0;n<e.length;n++)if(e[n]!==t&&o.a.getDistSquared(t,e[n])<u)return!1;return!0}e.a=function(){var t;do{t=a()}while(!i(t));var e=o.a.create("Star",t),n=e;if(r.a.float(0,1)<l)for(var c=r.a.int(1,s),p=0;p<c;p++)n=o.a.create("Planet",{star:e,orbitDistance:1600+p*r.a.int(2,5)*800,orbitRotation:r.a.float(-Math.PI,Math.PI)});return n};var o=n(4),r=n(15),c=n(33),s=2,l=.8,p=6e3,u=p*p},function(t,e,n){"use strict";e.a=function(t,e){var n=a.a[t];if("Star"===e.type)i.a.create("Freighter",{x:e.x+o.a.int(-100,100),y:e.y+o.a.int(-100,100),team:n,isOrbitingPlanet:!1,materialsFinished:500});else{var c={team:n,planet:e};e.pbase=i.a.create("PBase",c),e.pcolony=i.a.create("PColony",c),e.plab=i.a.create("PLab",c),e.pcomm=i.a.create("PComm",c),e.spaceport=i.a.create("SpacePort",c);var s=r({},c,{spaceport:e.spaceport});e.spacedock=i.a.create("SpaceDock",s),e.sensorarray=i.a.create("SensorArray",s),e.team=n,e.updateFlagColor()}};var a=n(11),i=n(4),o=n(15),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}},function(t,e,n){"use strict";function a(t,e,n,a,o){var r=t[o];r||(r=function(t,e){var n=new i.Graphics;return n.beginFill(0,0),n.lineStyle(1,t,1),n.drawRect(-e,-e,e,e),n.endFill(),s.addChild(n),n}(e,n),t[o]=r),r.x=a.x*f,r.y=a.y*f}var i=n(18),o=(n.n(i),n(4)),r=n(22),c=n(33),s=new i.Graphics;s.beginFill(0,1),s.lineStyle(1,16777215,.3),s.drawRect(0,0,100,100),s.endFill(),s.x=4,s.y=4;var l=[],p=[],u=[],h=[],f=100/c.a,y=0,d=a.bind(null,p,65280,2),g=a.bind(null,l,16776960,2),m=a.bind(null,h,11184810,1);e.a={init:function(){r.b.addChildToHUD(s)},update:function(){var t=Date.now();if(t-y>500){var e=o.a.getByType("Star");e&&(e.length!=l.length&&(l=l.slice(0,e.length-1)),e.forEach(g));var n=o.a.getByType("Planet");n&&(n.length!=p.length&&(p=p.slice(0,n.length-1)),n.forEach(d));var i=o.a.getByType("Fighter");i&&(i.length!=u.length&&(u=u.slice(0,i.length-1)),i.forEach(function(t,e){a(u,o.a.getTeamColor(t.team),1,t,e)}));var r=o.a.getByType("Freighter");r&&(r.length!=h.length&&(h=h.slice(0,r.length-1)),r.forEach(m)),y=t}}}},function(t,e,n){"use strict";function a(t){var e=t.trackWidth,n=t.trackColor,a=t.trackRadius,i=t.dialColor,o=t.dialSize,r=new p.Graphics;r.beginFill(0,0),r.lineStyle(e,n,f),r.drawCircle(0,0,a),r.endFill(),r.x=0,r.y=0;var c=new p.Graphics;c.beginFill(0,0),c.lineStyle(e,i,1);var s=.5*o;return c.arc(0,0,a,-s*y,s*y),c.endFill(),c.x=0,c.y=0,r.addChild(c),r}function i(t){t.nearestEnemy?(r.visible=!0,r.rotation=t.nearestEnemy):r.visible=!1,t.nearestStar?(s.visible=!0,s.rotation=t.nearestStar):s.visible=!1,t.nearestPlanet?(c.visible=!0,c.rotation=t.nearestPlanet):c.visible=!1}var o,r,c,s,l,p=n(18),u=(n.n(p),n(22)),h=n(4),f=.08,y=Math.PI/180,d=!0,g=0;e.a={init:function(){c=a({trackWidth:4,trackRadius:45,trackColor:16777215,dialColor:65280,dialSize:6}),s=a({trackWidth:4,trackRadius:50,trackColor:16777215,dialColor:16776960,dialSize:12}),r=a({trackWidth:1,trackRadius:50,trackColor:16777215,dialColor:16711680,dialSize:2});var t=new p.Text("Tactical Radar",{fontFamily:"arial",fontSize:8,fill:16316664,align:"center"});t.x=-t.width>>1,t.y=-t.height>>1,(o=new p.Container).addChild(c,s,r,t),o.x=54,o.y=162,o.visible=!0,u.b.addChildToHUD(o)},update:function(){if(l&&d){var t=Date.now();if(t-g>500){var e=h.a.getAbsoluteNearestByType(l,"Planet"),n=h.a.getAbsoluteNearestByType(l,"Star");i({nearestEnemy:void 0,nearestPlanet:e&&h.a.getAngleFromTo(l,e),nearestStar:n&&h.a.getAngleFromTo(l,n)}),g=t}}},setOrigin:function(t){var e=t.x,n=t.y;return l={x:e,y:n}},setRotations:i,set isEnabled(t){d=t,o.visible=t},get isEnabled(){return d}}},function(t,e,n){"use strict";function a(t){t.explode(t),r.a.destroy(t)}function i(t){"Star"===t.type?function(t){var e=r.a.getDistSquared(this,t);if(e<l){var n=t.x-this.x,i=t.y-this.y,o=this.mass*t.mass/Math.pow(e,1.5);this.dx+=n*o,this.dy+=i*o,e<s.a.DIST_SURFACE2&&a(this)}}.call(this,t):"Planet"===t.type&&function(t){var e=r.a.getDistSquared(this,t);if(e<p){var n=this.mass*t.mass/Math.pow(e,1.5),i=t.x-this.x,o=t.y-this.y;if(this.dx+=i*n,this.dy+=o*n,e<c.a.DIST_SURFACE2){var s=this.dx*this.dx+this.dy*this.dy,l=this.rotation,y=r.a.getAngleFromTo(t,this),d=Math.abs(y-l);d>Math.PI&&(l>0?l-=f:l+=f,d=Math.abs(y-l)),d<u&&s<h?this.dockPlanet(t):a(this)}}}.call(this,t)}function o(t){t&&!t.isDockedPlanet&&t.hp>0&&r.a.getNearest(t).forEach(i.bind(t))}e.a=function(){r.a.getByType("Fighter").forEach(o)};var r=n(4),c=n(126),s=n(127),l=Math.pow(1e3,2),p=Math.pow(800,2),u=Math.PI/4,h=4.41,f=2*Math.PI},function(t,e,n){"use strict";function a(t){return!t.pbase||!t.pcolony}function i(t,e){return e.team===t}function o(t){return t.pcolony&&t.plab&&!t.plab.isManufacturing}function r(t,e){if(t){var n=s.a.arrayElement(t).plab;n&&n.orderManufacture(e)}}e.a=function(){var t=Date.now();t-p>l&&(function(t){var e,n=i.bind(null,t),s=c.a.getByType("Planet").filter(n),l=c.a.getByType("Freighter").filter(n);l&&(l=l.filter(i.bind(null,t))),s&&((s=s.filter(i.bind(null,t))).filter(a).forEach(function(t,e){if(t)for(var n=t.length-1;n>=0;n--){var a=t[n];if(!a.isOrbitingPlanet&&!a.target||a.target&&"Planet"!==a.target.type){a.target=e,a.planet=void 0;break}}}.bind(null,l)),e=(e=s.filter(o)).length>0?e:void 0,l&&s.length>l.length&&r(e,"Freighter")),0===c.a.getByType("Fighter").filter(n).length&&r(e,"Fighter")}(c.a.TEAM.MAGENTA),p=t)};var c=n(4),s=n(15),l=3e3,p=0},function(t,e,n){"use strict";var a=n(61),i=n(128),o=0,r=1e3/15;e.a={update:function(){var t=Date.now(),e=t-o;if(e>r){var n=a.a.getDevice().getInputState();n.up||n.up_arrow?i.a.prevButton():n.down||n.down_arrow?i.a.nextButton():(n.f||n.button0)&&i.a.clickButton(),o=t-e%r}}}},function(t,e,n){"use strict";var a=n(23),i=n(309),o=n.n(i),r=n(361),c=n.n(r),s=/(^sounds\/|\.ogg$)/gi;e.a={load:function(){return new Promise(function(t,e){c.a.getBinaryContent("assets.zip",function(n,a){n?e(n):t(a)})}).then(function(t){return o.a.loadAsync(t)}).then(function(t){return function(e){var n=[],i=[];return t.folder("sounds/").forEach(function(t,e){n.push(e.name.replace(s,"")),i.push(e.async("arraybuffer"))}),Promise.all(i).then(function(t){return t.forEach(function(t,e){return Object(a.a)({name:n[e],arrayBuffer:t})})})}()})}}},,,,,,function(t,e){}],[157]);