webpackJsonp([0],[function(t,e,a){"use strict";function n(t,e){var a=e.x-t.x,n=e.y-t.y;return Math.pow(a,2)+Math.pow(n,2)}function i(t){var e=c.a.getByType(t);e&&e.forEach(r.a.update)}function o(){A.prepareNext(),F=F.filter(j)}e.b=n;var r=a(269),c=a(315),s=a(316),l=a(317),u=a(318),p=a(319),h=a(320),d=a(321),f=a(322),y=a(323),m=a(324),g=a(325),v=a(326),_=a(327),b=a(328),T=a(329),S=a(330),E=a(331),x=a(332),O=a(128),w=a(129),C=this&&this.__assign||Object.assign||function(t){for(var e,a=1,n=arguments.length;a<n;a++){e=arguments[a];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},A=new s.a,P={Probe:y.a,PBase:p.a,PColony:h.a,PComm:d.a,PLab:f.a,SpacePort:v.a,SpaceDock:g.a,SensorArray:m.a,Fighter:l.a,Freighter:u.a,Shield:_.a},F=[],M={CannonShot:b.a,HeavyCannonShot:T.a,LaserBolt:S.a,HomingMissile:E.a,ClusterRocket:x.a},D=[],R={Star:w.a,Planet:O.a},k=C({},R,P,M),I=Object.keys(R).concat(Object.keys(P),Object.keys(M)),j=function(t){return t.hp>0};e.a={create:function(t,e){var a;return t in k&&(a=new k[t](e),r.a.init(a),c.a.add(a),t in R&&D.push(a)),a},updateAll:function(){I.forEach(i)},commit:function(t){t.type in P&&A.commit(t)},prepareNext:o,getBodies:function(){return D},getAbsoluteNearestByBodyType:function(t,e){var a,i=1/0;return D.filter(function(t){return t.type===e}).forEach(function(e){var o=n(t,e);o<i&&(i=o,a=e)}),a},getNearestEnemyUnit:function(t,e){return void 0===e&&(e=1/0),A.getNearestEnemy(t,e)},getNearestUnits:function(t){return A.get1CellRadiusAroundEntity(t)},clearAll:function(){for(var t=0;t<4;t++)o();D=[],c.a.clearAll()},destroy:c.a.remove,getByType:c.a.getByType,getDistSquared:n,getAngleFromTo:function(t,e){var a=e.x-t.x,n=e.y-t.y;return Math.atan2(n,a)}}},,,,,function(t,e,a){"use strict";e.b=function(t,e){var a=t.x,n=t.y,o=e.geo.collider,c=r(a,n);return o instanceof i.Circle?Object(i.pointInCircle)(c,o):Object(i.pointInPolygon)(c,o)},a.d(e,"c",function(){return s}),e.a=function(t){var e,a=t.lineStyle,s=t.fill,l=t.path,u=t.radius,p=t.x,h=t.y,d=t.collisionPath,f=t.collisionRadius,y=t.type,m=new n.Graphics;a&&m.lineStyle(a.width,a.color,a.alpha),s?m.beginFill(s.color,s.alpha):m.beginFill(0,0),m.x=p||0,m.y=h||0;var g=r(m.x,m.y);if("circle"===y)m.drawCircle(0,0,u),e=new i.Circle(g,f||u);else{for(var v=[],_=d||l,b=0;b<_.length;b+=2)v.push(r(_[b],_[b+1]));m.drawPolygon(l),e=new i.Polygon(g,v)}return m.endFill(),{set x(t){t<0?t=0:t>o.d&&(t=o.d),this.graphics.x=t,this.collider.pos.x=t},set y(t){t<0?t=0:t>o.d&&(t=o.d),this.graphics.y=t,this.collider.pos.y=t},set rotation(t){t>c?t-=c:t<-c&&(t+=c),this.collider instanceof i.Circle||(this.collider.setAngle(t),this.graphics.rotation=t)},get x(){return this.graphics.x},get y(){return this.graphics.y},get rotation(){return this.graphics.rotation},graphics:m,collider:e}};var n=a(7),i=(a.n(n),a(278)),o=(a.n(i),a(6)),r=function(t,e){return new i.Vector(t,e)},c=2*Math.PI,s=function(t,e,a,n,i){return void 0===e&&(e=0),void 0===a&&(a=0),void 0===n&&(n=1),void 0===i&&(i=1),t.map(function(t,o){return o%2==0?t*n+e:t*i+a})}},function(t,e,a){"use strict";a.d(e,"d",function(){return n}),a.d(e,"e",function(){return i}),a.d(e,"a",function(){return o}),a.d(e,"b",function(){return r}),a.d(e,"c",function(){return c}),a.d(e,"f",function(){return s}),a.d(e,"g",function(){return l}),a.d(e,"h",function(){return u});var n=32768,i=.05,o=.2,r=1,c={d:[0,0,266.6666666666667,0,400,100,400,300,266.6666666666667,400,0,400,0,0],f:[400,0,0,0,0,400,0,200,300,200],g:[400,0,100,0,0,100,0,300,100,400,300,400,400,300,400,166.66666666666669,200,166.66666666666669],h:[0,0,0,400,0,200,400,200,400,0,400,400],j:[400,0,400,333.33333333333337,333.33333333333337,400,66.66666666666667,400,0,333.33333333333337],k:[0,0,0,400,0,200,266.6666666666667,200,400,0,266.6666666666667,200,400,400],n:[0,400,0,0,400,400,400,0],p:[0,400,0,0,300,0,400,100,300,200,0,200],q:[66.66666666666667,0,0,66.66666666666667,0,266.6666666666667,66.66666666666667,333.33333333333337,300,333.33333333333337,400,400,200,266.6666666666667,300,333.33333333333337,366.6666666666667,266.6666666666667,366.6666666666667,66.66666666666667,300,0,66.66666666666667,0],r:[0,400,0,0,300,0,400,100,300,200,0,200,300,200,400,266.6666666666667,400,400],u:[400,0,400,400,66.66666666666667,400,0,333.33333333333337,0,0],v:[0,0,0,133.33333333333334,200,400,400,133.33333333333334,400,0],w:[0,0,0,400,200,166.66666666666669,400,400,400,0],x:[0,0,0,100,66.66666666666667,200,200,200,66.66666666666667,200,0,300,0,400,0,300,66.66666666666667,200,333.33333333333337,200,400,100,400,0,400,100,333.33333333333337,200,400,300,400,400],y:[0,0,0,200,133.33333333333334,266.6666666666667,266.6666666666667,266.6666666666667,400,200,400,0,400,200,266.6666666666667,266.6666666666667,200,266.6666666666667,200,400],z:[0,0,400,0,400,33.333333333333336,0,300,0,400,400,400],c:[400,100,300,0,100,0,0,100,0,300,100,400,300,400,400,300],e:[400,0,0,0,0,200,300,200,0,200,0,400,400,400],l:[0,0,0,400,400,400],s:[400,0,100,0,0,100,100,200,300,200,400,300,300,400,0,400],t:[0,0,200,0,200,400,200,0,400,0],i:[0,0,400,0,200,0,200,400,0,400,400,400],a:[0,400,0,166.66666666666669,200,0,400,166.66666666666669,400,400,400,200,0,200],b:[400,100,300,0,0,0,0,400,300,400,400,300,300,200,0,200,300,200,400,100],m:[0,400,0,0,200,266.6666666666667,400,0,400,400],o:[0,100,100,0,300,0,400,100,400,300,300,400,100,400,0,300,0,100],symbol:[[0,233.33333333333334,0,166.66666666666669,33.333333333333336,66.66666666666667,66.66666666666667,33.333333333333336,166.66666666666669,0,233.33333333333334,0,333.33333333333337,33.333333333333336,366.6666666666667,66.66666666666667,400,166.66666666666669,400,233.33333333333334,366.6666666666667,333.33333333333337,333.33333333333337,366.6666666666667,233.33333333333334,400,166.66666666666669,400,66.66666666666667,366.6666666666667,33.333333333333336,333.33333333333337,0,233.33333333333334,400,166.66666666666669],[33.333333333333336,66.66666666666667,366.6666666666667,333.33333333333337]]},s={NONE:-1,BLUE:0,GREEN:1,RED:2,YELLOW:3,MAGENTA:4},l=[255,65280,16711680,16776960,16711935],u=function(t){return t===s.MAGENTA}},,function(t,e,a){"use strict";var n=a(6),i=function(){function t(){this.team=n.f.NONE}return Object.defineProperty(t.prototype,"x",{get:function(){return this.geo.x},set:function(t){this.geo.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.geo.y},set:function(t){this.geo.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.geo.rotation},set:function(t){this.geo.rotation=t},enumerable:!0,configurable:!0}),t.prototype.getChildAt=function(t){return this.geo.graphics.getChildAt(t)},t.prototype.setChildVisible=function(t,e){this.getChildAt(t).visible=e},t.prototype.assignTeamColor=function(){var t=n.g[this.team];return this.geo.graphics.currentPath.lineColor=t,t},t.prototype.renderHit=function(){this.hitTime>0?(this.hitTime--,this.geo.graphics.alpha=Math.random()):0===this.hitTime&&(this.hitTime=-1,this.geo.graphics.alpha=1)},t}();e.a=i},,,function(t,e,a){"use strict";e.a=function(t){var e=t.name,a=t.arrayBuffer;try{o.decodeAudioData(a).then(function(t){r[e]=t})}catch(t){console.warn('Failed to decode audio file "'+e+'"! '+t.toString())}},e.b=function(t){var e=o.createBufferSource();e.buffer=r[t],e.connect(o.destination),e.start()},e.c=function(t,e){var a=i.a.getFocus(),l=Math.max(n.a.getDistSquared(e,a),1);if(l<c){var u=o.createBufferSource(),p=o.createGain();u.buffer=r[t],p.gain.value=1-Math.log(l)*s,u.connect(p),p.connect(o.destination),u.start()}};var n=a(0),i=a(43),o=new AudioContext,r={},c=Math.pow(3e3,2),s=1/Math.log(c)},,function(t,e,a){"use strict";var n=function(t,e){return Math.round(i(t,e))},i=function(t,e){return t+Math.random()*(e-t)};e.a={int:n,float:i,arrayElement:function(t){return t[n(0,t.length-1)]}}},,function(t,e,a){"use strict";function n(){r=innerWidth,s=innerHeight,c=r>>1,l=s>>1,o&&o.resize(r,s)}a.d(e,"a",function(){return h});var i=a(7);a.n(i),i.settings.SCALE_MODE=i.SCALE_MODES.NEAREST;var o,r,c,s,l,u=new i.Container,p=new i.Container,h=function(t){return u.addChild(t)},d=function(){for(;p.children[0];)p.removeChild(p.children[0]);for(;u.children[0];)u.removeChild(u.children[0]);u.addChild(p)};e.b={init:function(){d(),void 0===o&&(addEventListener("resize",n),n(),u.addChild(p),o=new i.WebGLRenderer(r,s),document.body.appendChild(o.view))},setGlobalAlpha:function(t){return u.alpha=t},addChild:function(t){return p.addChild(t)},removeChild:function(t){return p.removeChild(t)},removeAllChildren:d,render:function(){return o.render(u)},centerOn:function(t){t&&(p.x=c-t.x,p.y=l-t.y)},addChildToHUD:h,removeChildFromHUD:function(t){return u.removeChild(t)}}},,,,,,,,,function(t,e,a){"use strict";var n=a(273),i=a(274),o=a(275),r=a(276),c=a(277),s=a(279),l=a(6);e.a={init:function(){s.a.init(),c.a.init(),o.a.init(),r.a.init(),n.a.init(),i.a.init()},update:function(){s.a.update(),r.a.update(),o.a.update(),n.a.update(),i.a.update()},displayText:function(t,e){Object(l.h)(t)&&s.a.displayText(e)},setFocus:o.a.setOrigin,setPauseVisible:c.a.setVisible}},,,,,,,,,,function(t,e,a){"use strict";function n(){var t=this;this.buttons.forEach(function(e,a){a===t.activeIndex?e.mouseover():e.mouseout()})}function i(){this.activeIndex--,this.activeIndex<0&&(this.activeIndex=0),this.updateButtonState()}function o(){this.activeIndex++;var t=this.buttons.length-1;this.activeIndex>t&&(this.activeIndex=t),this.updateButtonState()}function r(){var t=this.buttons[this.activeIndex];t&&t.click()}var c=a(7),s=(a.n(c),a(15));e.a={create:function(t){var e=t.width,a=void 0===e?640:e,s=t.height,l=void 0===s?480:s,u=new c.Graphics;u.lineStyle(1,65280,1),u.beginFill(0,1),u.drawRect(0,0,a,l),u.endFill();var p=function(){u.x=(innerWidth-a)/2,u.y=(innerHeight-l)/2};return p(),addEventListener("resize",p),{modal:u,onResize:p,activeIndex:-1,buttons:[],updateButtonState:n,prevButton:i,nextButton:o,clickButton:r}},destroy:function(t){var e=t.modal,a=t.onResize;s.b.removeChildFromHUD(e),removeEventListener("resize",a)}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(11));e.a={create:function(t){var e=t.text,a=t.width,o=void 0===a?300:a,r=t.height,c=void 0===r?40:r,s=t.onClick,l=new n.Graphics;l.lineStyle(1,16777215,1),l.drawRect(0,0,o,c),l.tint=65280;var u=new n.Text(e,{fontFamily:"arial",fontSize:12,fill:16777215,align:"center"});return u.x=(o-u.width)/2,u.y=(c-u.height)/2,l.addChild(u),l.interactive=!0,l.interactiveChildren=!1,l.buttonMode=!0,l.hitArea=new n.Rectangle(0,0,o,c),l.mouseover=function(t){var e=(t||{currentTarget:this}).currentTarget;e.tint=16777215,e.getChildAt(0).tint=16711680,Object(i.b)("switch-flick")},l.mouseout=function(t){var e=(t||{currentTarget:this}).currentTarget;e.tint=65280,e.getChildAt(0).tint=16777215},l.click=function(){s(),Object(i.b)("nav")},l}}},,,,,,,,function(t,e,a){"use strict";var n,i=a(8);e.a={getFocus:function(){return n instanceof i.a?{x:n.x,y:n.y}:n},setFocus:function(t){return n=t}}},function(t,e,a){"use strict";var n,i=a(64),o=a(66),r=a(43),c=a(264),s=a(265),l=a(127),u=a(266),p=function(t){return n=t};e.a={update:function(){var t=o.a.getDevice(),e=t.getEvents(),a=t.getInputState();if(e.PAUSE&&i.a.togglePause(),i.a.getIsPaused())n&&n.modal&&Object(c.a)(n,a);else if(n)if(n.modal)Object(c.a)(n,a);else if(n.hp>0)switch(l.a.setIconVisible(!1),r.a.setFocus(n),n.type){case"Fighter":Object(s.a)(n,e)}else u.a.setPosition(n),p(null);else r.a.setFocus(u.a.update(a)),l.a.setIconVisible(!0)},getControlledEntity:function(){return n},setControlledEntity:p}},,,,,,,,,,,,,,,,,,,,function(t,e,a){"use strict";function n(){var t=Date.now(),e=t-l;if(!M&&(v.a.update(),m.a.updateAll(),m.a.prepareNext()),f.a.update(),e>C){A&&(P<1?P+=F:(P=1,A=!1),h.b.setGlobalAlpha(P));var a=d.a.getFocus();a&&(g.a.setFocus(a),h.b.centerOn(a)),p.a.process(a),g.a.update(),h.b.render(),l=t-e%C}s=requestAnimationFrame(n)}function i(){M=!1,c(),f.a.setControlledEntity(null)}function o(t){if(Object(w.h)(t)){M=!0;var e=E.a.create({onClickContinue:i});h.b.addChildToHUD(e.modal),f.a.setControlledEntity(e)}}function r(t){if(Object(w.h)(t)){M=!0;var e=S.a.create({onClickContinue:i});h.b.addChildToHUD(e.modal),f.a.setControlledEntity(e)}}function c(){A=!0,P=0,m.a.clearAll(),h.b.init(),_.a.init(),p.a.init().forEach(h.b.addChild),g.a.init(),y.a.init(),v.a.init(),v.a.setOnTeamLostCallback(o),v.a.setOnTeamWinCallback(r)}var s,l,u,p=a(65),h=a(15),d=a(43),f=a(44),y=a(267),m=a(0),g=a(24),v=a(334),_=a(127),b=a(335),T=a(336),S=a(337),E=a(338),x=a(339),O=a(11),w=a(6),C=1e3/60,A=!0,P=0,F=.05,M=!1,D=function(){f.a.setControlledEntity(u),M=!1,u=null},R=function(){M=!0;var t=T.a.create({fighter:u,onClickWeapon:D});h.b.addChildToHUD(t.modal),f.a.setControlledEntity(t)};e.a={init:c,start:function(){l=Date.now(),n()},stop:function(){cancelAnimationFrame(s)},showDockedModal:function(){M=!0,u=f.a.getControlledEntity();var t=b.a.create({onClickSetHomePlanet:function(){v.a.setHumanTeamHomePlanet(u.planet||u.spaceport.planet),D()},onClickSwapWeapon:R,onClickDone:D});h.b.addChildToHUD(t.modal),f.a.setControlledEntity(t)},togglePause:Object(x.a)(function(){M=!M,Object(O.b)(M?"pause":"electric-fizzle"),g.a.setPauseVisible(M)},250),getIsPaused:function(){return M}}},function(t,e,a){"use strict";function n(t){var e=t.color,a=t.size,n=t.x,i=t.y,o=new c.Graphics;return o.beginFill(e),o.drawRect(0,0,a,a),o.lineWidth=a,o.endFill(),o.x=n,o.y=i,o}function i(){d=null}function o(t){if(t){var e=t.x,a=t.y,n=0,i=0;d?(n=e-d.x,i=a-d.y):function(t){p=innerWidth>>1,h=innerHeight>>1,l.forEach(function(e){e.x=t.x+s.a.float(-p,p),e.y=t.y+s.a.float(-h,h)})}(t),l.forEach(function(t,e,a,n){1===n.lineWidth?(t*=u.DIM.speed,e*=u.DIM.speed):(t*=u.BRIGHT.speed,e*=u.BRIGHT.speed),n.x+=t,n.y+=e,n.x<a.x-p?n.x=a.x+p:n.x>a.x+p&&(n.x=a.x-p),n.y<a.y-h?n.y=a.y+h:n.y>a.y+h&&(n.y=a.y-h)}.bind(null,n,i,t)),d={x:e,y:a}}else d=null}var r,c=a(7),s=(a.n(c),a(13)),l=[],u={BRIGHT:{speed:.01,count:8,size:2,color:11184810,x:0,y:0},DIM:{speed:.3,count:20,size:1,color:15790320,x:0,y:0}},p=innerWidth>>1,h=innerHeight>>1,d=null;e.a={init:function(){var t;if(0===l.length){for(t=0;t<u.DIM.count;t++)l.push(n(u.DIM));for(t=0;t<u.BRIGHT.count;t++)l.push(n(u.BRIGHT))}else o(null);return r||(r=addEventListener("resize",i)),l},process:o}},function(t,e,a){"use strict";var n,i=a(262),o=a(263);!function(t){t[t.Keyboard=0]="Keyboard",t[t.GamePad=1]="GamePad"}(n||(n={}));var r;e.a={init:function(){var t=location.search.indexOf("gamepad")>-1;r=t?n.GamePad:n.Keyboard},getDevice:function(){return r===n.Keyboard?o.a:i.a}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,a){"use strict";function n(){r.x=innerWidth-u,r.y=u}var i=a(7),o=(a.n(i),a(15)),r=new i.Graphics,c=[0,0,-1,-1,-.5,-1,-1,-1,-1,-.5,-1,-1].map(function(t){return 16*t}),s=function(t){var e=new i.Graphics;return e.lineStyle(1,34816,1),e.x=0,e.y=0,e.beginFill(0,0),e.lineWidth=1,e.drawPolygon(c),e.endFill(),e.rotation=t,e};r.addChild(s(0),s(.5*Math.PI),s(Math.PI),s(1.5*Math.PI));var l=function(t){return r.visible=t},u=20;e.a={init:function(){Object(o.a)(r),n(),l(!1),addEventListener("resize",n)},symbol:r,setIconVisible:l}},function(t,e,a){"use strict";var n=a(6),i=a(5),o=a(8),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),c={body:{type:"circle",radius:100,fill:{color:0,alpha:1},lineStyle:{width:1,color:65280,alpha:1}},flag:{type:"polygon",fill:{color:16777215,alpha:1},path:[-5,-4,-5,4,5,4,5,-4]}},s=function(t){function e(e){var a=t.call(this)||this;return a.type="Planet",a.canOrbitStar=!0,a.canStoreMaterial=!0,a.materialsRaw=0,a.materialsFinished=0,a.hp=2e3,a.mass=180,a.geo=Object(i.a)(c.body),a.geo.graphics.addChild(Object(i.a)(c.flag).graphics),Object.assign(a,e),a.updateFlagColor(),a}return r(e,t),e.prototype.isOccupied=function(){return Boolean(this.pbase||this.plab||this.pcolony||this.pcomm)},e.prototype.updateFlagColor=function(){var t=this.geo.graphics.children[0];this.team===n.f.NONE?t.visible=!1:(window.foo=t,window.doo=this,t.visible=!0,t.tint=n.g[this.team])},e.DIST_SURFACE2=11025,e}(o.a);e.a=s},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={type:"circle",radius:200,fill:{color:0,alpha:1},lineStyle:{width:1,color:16776960,alpha:1}},c=function(t){function e(e){var a=t.call(this)||this;return a.geo=Object(n.a)(r),a.type="Star",a.hp=1e4,a.mass=600,Object.assign(a,e),a}return o(e,t),e.DIST_SURFACE2=4e4,e}(i.a);e.a=c},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,a){"use strict";function n(){o.a.init(),o.a.start()}Object.defineProperty(e,"__esModule",{value:!0});var i=a(159),o=a(64),r=a(340),c=a(343),s=a(66),l=location.search.match(/game$/),u=location.search.match(/editor$/);addEventListener("DOMContentLoaded",function(){var t;l?t=n:u?t=i.a.start:(r.a.setFadeOutCallback(n),t=r.a.start),s.a.init(),c.a.load().then(t)})},function(t,e,a){"use strict";function n(){var t=Date.now(),e=t-o;e>s&&(r.a.render(),o=t-e%s),i=requestAnimationFrame(n)}var i,o,r=a(160),c=a(261),s=1e3/60;e.a={start:function(){r.a.init(),r.a.addChild(c.a.create(20,20)),o=Date.now(),n()},stop:function(){cancelAnimationFrame(i)}}},function(t,e,a){"use strict";function n(){r=innerWidth,c=innerHeight,o&&o.resize(r,c)}var i=a(7);a.n(i),i.settings.SCALE_MODE=i.SCALE_MODES.NEAREST;var o,r,c,s=new i.Container,l=function(){for(;s.children[0];)s.removeChild(s.children[0])};e.a={init:function(){l(),void 0===o&&(addEventListener("resize",n),n(),o=new i.WebGLRenderer(r,c),document.body.appendChild(o.view))},addChild:function(t){return s.addChild(t)},removeChild:function(t){return s.removeChild(t)},removeAllChildren:l,render:function(){return o.render(s)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";function getRelativeXY(t){var e=t.data.originalEvent,a=e.x,n=e.y,i=DIVISION/SIZE,o=1/i,r=a-editor.x,c=n-editor.y;return{x:r,y:c,gridX:Math.min(Math.round(r*i)*o,SIZE),gridY:Math.min(Math.round(c*i)*o,SIZE)}}function onClick(t){var e=editor.children,a=getRelativeXY(t),n=a.gridX,i=a.gridY,o=e[e.length-1],r=layerPoints[layerPoints.length-1];r.push(n),r.push(i),updateLayer(o,r)}function onMouseMove(t){var e=getRelativeXY(t),a=e.gridX,n=e.gridY;editor.children[1].x=a,editor.children[1].y=n}function deleteLayer(){layerPoints.length>1?(editor.removeChild(editor.children[editor.children.length-1]),layerPoints.pop()):layerPoints[0]=[],updatePreview()}function exportLayers(){var t=layerPoints.length>1?JSON.stringify(layerPoints):JSON.stringify(layerPoints[0]);prompt("Exported geometry",t)}function onKeyPress(t){var e;switch(t.which){case 115:setScale(),updatePreview();break;case 104:exportLayers();break;case 112:deleteLayer();break;case 113:addLayer();break;case 122:var a=editor.children;(e=layerPoints[layerPoints.length-1]).pop(),e.pop(),updateLayer(a[a.length-1],e)}}function create(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),(editor=new __WEBPACK_IMPORTED_MODULE_0_pixi_js__.Graphics).lineStyle(1,16777215,.25),editor.beginFill(0,0),editor.drawRect(0,0,SIZE,SIZE),editor.endFill(),editor.x=t,editor.y=e,editor.interactive=!0,editor.hitArea=new __WEBPACK_IMPORTED_MODULE_0_pixi_js__.Rectangle(0,0,SIZE,SIZE),editor.buttonMode=!0,editor.click=onClick,editor.mousemove=onMouseMove,drawGridLines(),drawHelpLabel(),addSnapCursor(),addPreviewWindow(),addLayer(),addEventListener("keypress",onKeyPress),editor}function addPreviewWindow(){(preview=new __WEBPACK_IMPORTED_MODULE_0_pixi_js__.Graphics).x=SIZE+20,preview.y=0,editor.addChild(preview)}function addSnapCursor(){var t=new __WEBPACK_IMPORTED_MODULE_0_pixi_js__.Graphics;t.lineStyle(1,16711680,1),t.drawRect(-2,-2,4,4),editor.addChild(t)}function addLayer(){editor.addChild(new __WEBPACK_IMPORTED_MODULE_0_pixi_js__.Graphics),layerPoints.push([])}function drawGridLines(){var t,e=SIZE/DIVISION;for(t=0;t<SIZE;t+=e)t>>0==SIZE>>1?editor.lineStyle(1,16777215,.5):editor.lineStyle(1,16777215,.25),editor.moveTo(t,0),editor.lineTo(t,SIZE);for(t=0;t<SIZE;t+=e)t>>0==SIZE>>1?editor.lineStyle(1,16777215,.5):editor.lineStyle(1,16777215,.25),editor.moveTo(0,t),editor.lineTo(SIZE,t)}function drawHelpLabel(){var t=new __WEBPACK_IMPORTED_MODULE_0_pixi_js__.Text(TEXT,{fontFamily:"arial",fontSize:12,fill:16777215});t.x=0,t.y=editor.height,editor.addChild(t)}function updateLayer(t,e){t.clear(),t.lineStyle(1,16711680,1),t.drawPolygon(e),updatePreview()}function updatePreview(){preview.clear(),preview.lineStyle(1,65280,1);var t=function(t,e){return e%2?scaleX*t:scaleY*t};layerPoints.forEach(function(e){return preview.drawPolygon(e.map(t))})}function destroy(){removeEventListener("keypress",onKeyPress)}var __WEBPACK_IMPORTED_MODULE_0_pixi_js__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_0_pixi_js___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_pixi_js__),TEXT="\nClick to add a new vertex to each polyline\n\nPress Z to undo last vertex\nPress Q / P to add / delete a layer\nPress H to export all layers\n\nPress S to set the scale of the preview / exported geometry\n",DIVISION=12,SIZE=400,scaleX=.25,scaleY=.25,layerPoints=[],editor,preview,setScale=function(){var userScaleX=prompt('Scale X coordinates\nYou may also use fractions here, e.g. "0.25" or "1/4"',scaleX.toString())||"1/4",userScaleY=prompt('Scale Y coordinates\nYou may also use fractions here, e.g. "0.25" or "1/4"',scaleY.toString())||"1/4";scaleX=parseFloat(eval(userScaleX)),scaleY=parseFloat(eval(userScaleY))};__webpack_exports__.a={create:create,destroy:destroy}},function(t,e,a){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,a=1,n=arguments.length;a<n;a++){e=arguments[a];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},i=.1,o=1e-6,r=function(t){var e=t.left,a=t.right,n=(t.up,t.analogAngle),i=t.button0,o=t.button1,r=t.button2,c=t.button3;return{TURN_LEFT:Boolean(e),TURN_RIGHT:Boolean(a),ACCELERATE:Boolean(c),SPECIAL:Boolean(o),SHOOT:Boolean(i),PAUSE:Boolean(r),analogAngle:n}},c={left:!1,right:!1,up:!1,down:!1,analogAngle:0,button0:!1,button1:!1,button2:!1,button3:!1};e.a={getEvents:function(t){void 0===t&&(t=0);var e=navigator.getGamepads()[t];if(e){var a=e.axes,n=a[0],s=a[1],l=Math.abs(n)>i,u=Math.abs(s)>i,p=void 0;(l||u)&&(l||(n=n>0?o:-o),u||(s=s>0?o:-o),p=Math.atan2(s,n)),c={left:e.axes[0]<-i,right:e.axes[0]>i,up:e.axes[1]<-i,down:e.axes[1]>i,analogAngle:p,button0:e.buttons[0].pressed,button1:e.buttons[1].pressed,button2:e.buttons[2].pressed,button3:e.buttons[3].pressed}}return r(c)},getInputState:function(){return n({},c)}}},function(t,e,a){"use strict";function n(t){var e=t.which;c[r[e]]=!1}function i(t){var e=t.which;c[r[e]]=!0}var o=this&&this.__assign||Object.assign||function(t){for(var e,a=1,n=arguments.length;a<n;a++){e=arguments[a];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},r={37:"left_arrow",38:"up_arrow",39:"right_arrow",40:"down_arrow",69:"e",80:"p",70:"f"},c={left_arrow:!1,right_arrow:!1,up_arrow:!1,down_arrow:!1,p:!1,e:!1,f:!1};window&&(window.addEventListener("keydown",i),window.addEventListener("keyup",n)),e.a={getEvents:function(){return{PAUSE:Boolean(c.p),SPECIAL:Boolean(c.e),TURN_LEFT:Boolean(c.left_arrow),TURN_RIGHT:Boolean(c.right_arrow),ACCELERATE:Boolean(c.up_arrow),SHOOT:Boolean(c.f)}},getInputState:function(){return o({},c)}}},function(t,e,a){"use strict";e.a=function(t,e){var a=Date.now(),o=a-n;o>i&&(e.up||e.up_arrow?t.prevButton():e.down||e.down_arrow?t.nextButton():(e.f||e.button0||e.button1||e.button2||e.button3)&&t.clickButton(),n=a-o%i)};var n=0,i=62.5},function(t,e,a){"use strict";e.a=function(t,e){var a=t.isDockedPlanet,o=t.isDockedSpacePort,r=t.team,c=t.planet,s=t.spaceport,l=a||o;l?e.SPECIAL&&(a&&c.team===r||o&&s.team===r)&&n.a.showDockedModal():("number"==typeof e.analogAngle?t.rotation=e.analogAngle:e.TURN_LEFT?t.rotation-=i.e:e.TURN_RIGHT&&(t.rotation+=i.e),t.isAttacking=e.SHOOT),e.ACCELERATE?(l&&(a?t.undockPlanet():o&&t.undockSpacePort(),t.accelerate(i.b)),t.flameOn(),t.accelerate(i.a)):t.flameOff()};var n=a(64),i=a(6)},function(t,e,a){"use strict";var n={x:0,y:0};e.a={setPosition:function(t){var e=t.x,a=t.y;return n={x:e,y:a}},update:function(t){return(t.up_arrow||t.up)&&(n.y-=40),(t.down_arrow||t.down)&&(n.y+=40),(t.left_arrow||t.left)&&(n.x-=40),(t.right_arrow||t.right)&&(n.x+=40),n}}},function(t,e,a){"use strict";var n=a(13),i=a(268),o=a(333),r=["BLUE","GREEN","RED","YELLOW","MAGENTA"];e.a={init:function(){for(var t=n.a.int(2,5),e=r.slice(),a=0;a<t;a++){var c=Object(i.a)(),s=e.pop();s&&Object(o.a)(s,c)}}}},function(t,e,a){"use strict";function n(){return{x:r.a.float(u,c.d-u),y:r.a.float(u,c.d-u)}}function i(t){for(var e=o.a.getByType("Star"),a=0;a<e.length;a++)if(e[a]!==t&&o.a.getDistSquared(t,e[a])<p)return!1;return!0}e.a=function(){var t;do{t=n()}while(!i(t));var e=o.a.create("Star",t),a=e;if(r.a.float(0,1)<l)for(var c=r.a.int(1,s),u=0;u<c;u++)a=o.a.create("Planet",{star:e,orbitDistance:1600+u*r.a.int(2,5)*800,orbitRotation:r.a.float(-Math.PI,Math.PI)});return a};var o=a(0),r=a(13),c=a(6),s=2,l=.8,u=8e3,p=Math.pow(u,2)},function(t,e,a){"use strict";var n=a(0),i=a(270),o=a(271),r=a(272),c=a(280),s=a(281),l=a(282),u=a(283),p=a(284),h=a(285),d=a(286),f=a(287),y=a(288),m=a(289),g=a(290),v=a(291),_=a(292),b=a(293),T=a(294),S=a(295),E=a(296),x=a(297),O=a(298),w=a(299),C=a(300),A=a(301),P=a(302),F=a(303),M=a(304),D=a(305),R=a(306),k=a(307),I=a(308),j=a(309),L=a(310),H=a(311),B=a(312),N=a(313),U=[a(314).a,k.a,I.a,f.a,_.a,b.a,F.a,M.a,D.a,l.a,u.a,T.a,S.a,P.a,o.a,E.a,h.a,p.a,c.a,B.a,d.a,m.a,g.a,r.a,i.a,x.a,O.a,w.a,C.a,A.a,L.a,j.a,s.a,R.a,H.a,v.a,N.a,y.a];e.a={init:function(t){U.forEach(function(e){e.DEFAULTS&&t[e.componentFlag]&&Object.keys(e.DEFAULTS).forEach(function(a){void 0===t[a]&&(t[a]=e.DEFAULTS[a])})})},update:function(t){t.hp>0?U.forEach(function(e){t[e.componentFlag]&&e.process&&e.process(t)}):t[v.a.componentFlag]&&v.a.process(t),t.hp>0?n.a.commit(t):n.a.destroy(t)}}},function(t,e,a){"use strict";e.a={componentFlag:"canAttack",DEFAULTS:{attackTurretPositions:[],attackTarget:null,attackWeapon:"Cannon",isAttacking:!1}}},function(t,e,a){"use strict";var n=a(0);e.a={componentFlag:"canAutoTargetEnemy",DEFAULTS:{AUTO_TARGET_ENEMY_TIME:1500,autoTargetSearchDist2:16e4,autoTargetLastSearchTime:0},process:function(t){if(t.canAttack){var e=Date.now();e-t.autoTargetLastSearchTime>=t.AUTO_TARGET_ENEMY_TIME&&(function(t){t.attackTarget=n.a.getNearestEnemyUnit(t,t.autoTargetSearchDist2),t.isAttacking=Boolean(t.attackTarget)}(t),t.autoTargetLastSearchTime=e)}}}},function(t,e,a){"use strict";var n=a(0),i=a(13),o=a(24),r={Freighter:{cost:800,time:1500},Fighter:{cost:500,time:100}},c={orderManufacture:function(t){this.isManufacturing||(this.isManufacturing=!0,this.manufactureTime=r[t].time,this.manufactureType=t,o.a.displayText(this.team,"Manufacturing new "+t+"."))},isManufacturing:!1,manufactureTime:0,manufactureType:void 0};e.a={componentFlag:"canManufacture",DEFAULTS:c,process:function(t){if(t.isManufacturing){var e=t.planet,a=t.team;if(t.planet.pbase&&t.planet.pbase.materialsFinished>=t.PRODUCT[t.manufactureType].cost)if(t.manufactureTime>0)t.manufactureTime--;else{var r=t.x+i.a.int(-20,20),c=t.y+i.a.int(-20,20),s=n.a.create(t.manufactureType,{x:r,y:c,team:a});"Fighter"===t.manufactureType?e.spaceport&&!e.spaceport.isCarryingFighter?s.dockSpacePort(e.spaceport):s.dockPlanet(e):"Freighter"===t.manufactureType&&s.enterPlanetOrbit(e),o.a.displayText(a,"New "+s.type+" manufactured."),t.isManufacturing=!1,t.manufactureType=void 0}}}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(15)),o=a(44),r=new n.Graphics;r.x=4,r.y=216;var c=new n.Text("Unknown",{fontFamily:"arial",fontSize:12,fill:16316664,align:"left"});c.x=0,c.y=0;var s=new n.Graphics;s.x=0,s.y=16;var l=new n.Graphics;l.x=0,l.y=16,r.addChild(c),r.addChild(s),r.addChild(l),e.a={init:function(){i.b.addChildToHUD(r)},update:function(){var t=o.a.getControlledEntity();t&&(c.text=t.type,function(t){var e=t.hp,a=t.maxHp,n=Math.floor(e/a*100);s.clear(),s.beginFill(6728294,1),s.drawRect(0,0,n,12),s.endFill(),l.clear(),l.beginFill(11167334,1),l.drawRect(0,0,100-n,12),l.endFill(),l.x=n}(t))}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(15)),o=a(44),r=new n.Graphics;r.x=4,r.y=248;var c=new n.Text("Unarmed",{fontFamily:"arial",fontSize:12,fill:16316664,align:"left"});c.x=0,c.y=0;var s=new n.Text("",{fontFamily:"arial",fontSize:12,fill:16711680,align:"left"});s.x=0,s.y=14,r.addChild(c),r.addChild(s),e.a={init:function(){i.b.addChildToHUD(r)},update:function(){var t=o.a.getControlledEntity();if(t){var e=t.attackWeapon,a=t.canAttack,n=t.ammo_HomingMissile,i=t.ammo_ClusterRocket,r=t.ammo_LaserBolt;if(a)switch(c.text=e,e){case"HomingMissile":s.text="|".repeat(n);break;case"ClusterRocket":s.text="|".repeat(i);break;case"LaserBolt":s.text="|".repeat(r);break;case"HeavyCannon":case"Cannon":default:s.text=""}}else c.text="Freelook mode",s.text="ON"}}},function(t,e,a){"use strict";function n(t){var e=t.trackWidth,a=t.trackColor,n=t.trackRadius,i=t.dialColor,o=t.dialSize,r=new l.Graphics;r.beginFill(0,0),r.lineStyle(e,a,h),r.drawCircle(0,0,n),r.endFill(),r.x=0,r.y=0;var c=new l.Graphics;c.beginFill(0,0),c.lineStyle(e,i,1);var s=.5*o;return c.arc(0,0,n,-s*d,s*d),c.endFill(),c.x=0,c.y=0,r.addChild(c),r}var i,o,r,c,s,l=a(7),u=(a.n(l),a(15)),p=a(0),h=.08,d=Math.PI/180,f=!0,y=0;e.a={init:function(){r=n({trackWidth:4,trackRadius:45,trackColor:16777215,dialColor:65280,dialSize:6}),c=n({trackWidth:4,trackRadius:50,trackColor:16777215,dialColor:16776960,dialSize:12}),o=n({trackWidth:1,trackRadius:50,trackColor:16777215,dialColor:16711680,dialSize:2});var t=new l.Text("Tactical Radar",{fontFamily:"arial",fontSize:8,fill:16316664,align:"center"});t.x=-t.width>>1,t.y=-t.height>>1,(i=new l.Container).addChild(r,c,o,t),i.x=54,i.y=162,i.visible=!0,u.b.addChildToHUD(i)},update:function(){if(s&&f){var t=Date.now();if(t-y>500){var e=p.a.getAbsoluteNearestByBodyType(s,"Planet"),a=p.a.getAbsoluteNearestByBodyType(s,"Star");!function(t){t.nearestEnemy?(o.visible=!0,o.rotation=t.nearestEnemy):o.visible=!1,t.nearestStar?(c.visible=!0,c.rotation=t.nearestStar):c.visible=!1,t.nearestPlanet?(r.visible=!0,r.rotation=t.nearestPlanet):r.visible=!1}({nearestEnemy:void 0,nearestPlanet:e&&p.a.getAngleFromTo(s,e),nearestStar:a&&p.a.getAngleFromTo(s,a)}),y=t}}},setOrigin:function(t){var e=t.x,a=t.y;return s={x:e,y:a}},set isEnabled(t){f=t,i.visible=t},get isEnabled(){return f}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(0)),o=a(15),r=a(6),c=new n.Graphics,s=function(){c.beginFill(0,1),c.lineStyle(1,16777215,.3),c.drawRect(0,0,100,100),c.endFill()};c.x=4,c.y=4;var l=100/r.d,u=function(t){var e,a,n=t.type,i=t.team;switch(n){case"Planet":a=h,e=4;break;case"Star":a=p,e=2;break;case"Fighter":a=r.g[i],e=2;break;case"Freighter":default:a=d,e=1}var o=t.x*l,s=t.y*l;c.beginFill(0,0),c.lineStyle(1,a,1),c.drawRect(o-e/2,s-e/2,e,e),c.endFill()},p=16776960,h=65280,d=11184810,f=0;e.a={init:function(){o.b.addChildToHUD(c)},update:function(){var t=Date.now();t-f>500&&(c.clear(),s(),i.a.getByType("Star").forEach(u),i.a.getByType("Planet").forEach(u),i.a.getByType("Freighter").forEach(u),i.a.getByType("Fighter").forEach(u),f=t)}}},function(t,e,a){"use strict";function n(){s.x=.5*(innerWidth-s.width),s.y=.5*(innerHeight-s.height)+40}var i=a(7),o=(a.n(i),a(15)),r=a(6),c=a(5),s=new i.Graphics;s.lineStyle(1,16777215,1);var l,u;l=14,u=0,"game".split("").forEach(function(t){s.drawPolygon(Object(c.c)(r.c[t],l,u,.03125,.025)),l+=17}),l=0,u=20,"paused".split("").forEach(function(t){s.drawPolygon(Object(c.c)(r.c[t],l,u,.03125,.025)),l+=16}),e.a={init:function(){s.renderable=!1,o.b.addChildToHUD(s)},setVisible:function(t){s.renderable=t,t?(n(),addEventListener("resize",n)):removeEventListener("resize",n)}}},,function(t,e,a){"use strict";function n(){c.x=innerWidth-5,c.y=innerHeight}function i(){c.children.forEach(function(t,e){t.text=s[e],t.x=-t.width})}var o=a(7),r=(a.n(o),a(15)),c=new o.Container,s=[],l=400;e.a={init:function(){for(var t;c.children.length<8;){t=new o.Text("",{fontFamily:"arial",fontSize:12,fill:11184810}),c.addChild(t),s.push();var e=c.children.length-1;c.children[e].y=-20*(e+1)}s=[],i(),r.b.addChildToHUD(c),addEventListener("resize",n),n()},destroy:function(){removeEventListener("resize",n)},update:function(){l>0?l--:(l=400,s.shift(),i())},displayText:function(t){void 0===t&&(t=""),s.push(t),s.length>8&&s.shift(),i()}}},function(t,e,a){"use strict";e.a={componentFlag:"canMine",DEFAULTS:{MINE_RATE:25,MINE_TIME:20,mineTime:20},process:function(t){t.mineTime>0?t.mineTime--:(t.mineTime=t.MINE_TIME,t.planet.materialsRaw+=t.MINE_RATE)}}},function(t,e,a){"use strict";e.a={componentFlag:"canMetabolize",process:function(t){t.hp--}}},function(t,e,a){"use strict";var n=a(6);e.a={componentFlag:"canMoveLinearly",DEFAULTS:{dx:0,dy:0},process:function(t){t.isDockedPlanet||(t.x+=t.dx,t.y+=t.dy,0!==t.x&&t.x!==n.d||(t.dx=0),0!==t.y&&t.y!==n.d||(t.dy=0))}}},function(t,e,a){"use strict";var n=a(0),i={TURN_RATE:.07,SPEED:2.5,DIST_HALT2:Math.pow(80,2)},o=Math.pow(200,2);e.a={componentFlag:"canMoveToColonizationTarget",DEFAULTS:i,process:function(t){var e=t.isOrbitingPlanet,a=t.colonizationTarget,i=t.DIST_HALT2;if(!e&&a){var r=n.a.getDistSquared(t,a);if("Planet"===a.type&&(i=o),r>i){var c=function(t){var e=t.rotation,a=n.a.getAngleFromTo(t,t.colonizationTarget),i=Math.abs(a-e);return i>Math.PI?e>0?t.rotation+=t.TURN_RATE:t.rotation-=t.TURN_RATE:i>t.TURN_RATE?e>a?t.rotation-=t.TURN_RATE:t.rotation+=t.TURN_RATE:t.rotation=a,e=t.rotation}(t);t.x+=Math.cos(c)*t.SPEED,t.y+=Math.sin(c)*t.SPEED,t.flameOn&&t.flameOn()}else"Planet"===a.type&&t.canOrbitPlanet&&t.enterPlanetOrbit(a),t.flameOff&&t.flameOff()}}}},function(t,e,a){"use strict";e.a={componentFlag:"canHarvest",DEFAULTS:{HARVEST_RATE_RAW:35,HARVEST_RATE_FINISHED:25,HARVEST_TIME:10,harvestTime:0},process:function(t){t.harvestTime>0?t.harvestTime--:(t.harvestTime=t.HARVEST_TIME,t.planet.materialsRaw>0&&t.materialsRaw<t.MAX_RAW_MATERIALS&&(t.MAX_RAW_MATERIALS-t.materialsRaw<t.HARVEST_RATE_RAW?(t.planet.materialsRaw=0,t.materialsRaw+=t.MAX_RAW_MATERIALS-t.materialsRaw):(t.planet.materialsRaw-=t.HARVEST_RATE_RAW,t.materialsRaw+=t.HARVEST_RATE_RAW)),t.planet.materialsFinished>0&&t.materialsFinished<t.MAX_FINISHED_MATERIALS&&(t.MAX_FINISHED_MATERIALS-t.materialsFinished<t.HARVEST_RATE_FINISHED?(t.planet.materialsFinished=0,t.materialsFinished+=t.MAX_FINISHED_MATERIALS-t.materialsFinished):(t.planet.materialsFinished-=t.HARVEST_RATE_FINISHED,t.materialsFinished+=t.HARVEST_RATE_FINISHED)))}}},function(t,e,a){"use strict";e.a={componentFlag:"canStoreMaterial",DEFAULTS:{MAX_RAW_MATERIALS:3e3,MAX_FINISHED_MATERIALS:2e3,materialsRaw:0,materialsFinished:0},process:function(){}}},function(t,e,a){"use strict";e.a={componentFlag:"canRepair",DEFAULTS:{REPAIR_COST_FINISHED:25,REPAIR_TIME:30,repairTime:0},process:function(t){t.hp<t.maxHp&&t.materialsFinished>t.REPAIR_COST_FINISHED&&t.materialsFinished>0&&(t.repairTime>0?t.repairTime--:(t.hp++,t.materialsFinished-=t.REPAIR_COST_FINISHED,t.repairTime=t.REPAIR_TIME))}}},function(t,e,a){"use strict";var n=a(0);e.a={componentFlag:"canAnchor",process:function(t){t.anchor.hp>0?(t.x=t.anchor.x,t.y=t.anchor.y):n.a.destroy(t)}}},function(t,e,a){"use strict";e.a={DEFAULTS:{shield:null},componentFlag:"canBeShielded"}},function(t,e,a){"use strict";e.a={componentFlag:"canRefine",DEFAULTS:{REFINE_RATE_RAW_TO_FINISHED:.5},process:function(t){t.materialsFinished<t.MAX_FINISHED_MATERIALS?t.materialsRaw>0&&(t.materialsFinished+=t.REFINE_RATE_RAW_TO_FINISHED,t.materialsFinished>t.MAX_FINISHED_MATERIALS&&(t.planet.materialsFinished+=t.materialsFinished-t.MAX_FINISHED_MATERIALS,t.materialsFinished=t.MAX_FINISHED_MATERIALS),t.materialsRaw--):t.materialsRaw>0&&(t.planet.materialsFinished+=t.REFINE_RATE_RAW_TO_FINISHED,t.materialsRaw--)}}},function(t,e,a){"use strict";var n=a(0),i=[{type:"PLab",cost:200},{type:"PComm",cost:300},{type:"SpacePort",cost:1e3,prerequisite:"PColony"},{type:"SpaceDock",cost:500,prerequisite:"SpacePort",occupation:"SpacePort"},{type:"SensorArray",cost:500,prerequisite:"SpacePort",occupation:"SpacePort"}];e.a={componentFlag:"canConstruct",DEFAULTS:{constructionTime:8e3},process:function(t){t.materialsFinished>0&&(t.constructionTime>0?t.constructionTime--:(i.some(function(t){var e=this.team,a=this.planet,i=t.type.toLowerCase(),o=!0;return t.prerequisite&&(o=Boolean(this.planet[t.prerequisite.toLowerCase()])),!!(!this.planet[i]&&this.materialsFinished>=t.cost&&o)&&("SpacePort"===t.occupation?this.planet[i]=n.a.create(t.type,{spaceport:this.planet.spaceport,planet:a,team:e}):this.planet[i]=n.a.create(t.type,{planet:a,team:e}),this.materialsFinished-=t.cost,!0)}.bind(t)),t.constructionTime=8e3))}}},function(t,e,a){"use strict";function n(){var t=this.EXPLOSION_SOUND,e=this.EXPLOSION_FRAGMENTS,a=this.x,n=this.y,s=this.dx,l=this.dy,u=this.explosionOriginDx,p=this.explosionOriginDy;Object(i.c)(t,this);for(var h=e;h>0;h--)o.a.create("CannonShot",{x:u+a+r.a.float(-10,10),y:p+n+r.a.float(-10,10),team:c.f.NONE,dx:r.a.float(-2,2)+(s||0),dy:r.a.float(-2,2)+(l||0)});this.hasExploded=!0}var i=a(11),o=a(0),r=a(13),c=a(6),s={explosionOriginDx:0,explosionOriginDy:0,EXPLOSION_SOUND:"collide",EXPLOSION_FRAGMENTS:6,hasExploded:!1,explode:n};e.a={componentFlag:"canExplode",DEFAULTS:s,process:function(t){var e=t.hasExploded,a=t.canExplode;t.hp<=0&&!e&&a&&n.call(t)}}},function(t,e,a){"use strict";e.a={componentFlag:"canOccupyPlanet",process:function(t){t.x=t.planet.x,t.y=t.planet.y}}},function(t,e,a){"use strict";var n=a(0);e.a={componentFlag:"canOccupySpacePort",process:function(t){var e=t.spaceport,a=e.x,i=e.y,o=e.rotation;e.hp>0?(t.x=a,t.y=i,t.rotation=o):(t.explode&&t.explode(),n.a.destroy(t))}}},function(t,e,a){"use strict";e.a={componentFlag:"canOrbitStar",DEFAULTS:{D_ROTATION:1e-4,orbitDistance:1800,orbitRotation:0},process:function(t){t.orbitRotation+=t.D_ROTATION,t.x=Math.cos(t.orbitRotation)*t.orbitDistance+t.star.x,t.y=Math.sin(t.orbitRotation)*t.orbitDistance+t.star.y}}},function(t,e,a){"use strict";var n=a(0),i={enterPlanetOrbit:function(t){this.isOrbitingPlanet=!0,this.dx=0,this.dy=0,this.orbitRotation=n.a.getAngleFromTo(t,this),this.rotation=this.orbitRotation+o,this.planet=t,this.flameOff&&this.flameOff()},exitPlanetOrbit:function(){this.isOrbitingPlanet=!1,this.planet=void 0,this.flameOn&&this.flameOn()},isOrbitingPlanet:!0,D_ROTATION:1e-4,orbitDistance:105,orbitRotation:0},o=.5*Math.PI;e.a={componentFlag:"canOrbitPlanet",DEFAULTS:i,process:function(t){t.isOrbitingPlanet&&t.planet&&("SpacePort"===t.type?t.rotation=n.a.getAngleFromTo(t.planet,t):"Freighter"===t.type&&(t.rotation+=t.D_ROTATION),t.orbitRotation+=t.D_ROTATION,t.x=Math.cos(t.orbitRotation)*t.orbitDistance+t.planet.x,t.y=Math.sin(t.orbitRotation)*t.orbitDistance+t.planet.y)}}},function(t,e,a){"use strict";var n=a(11),i=a(0),o=a(5);e.a={componentFlag:"canDamage",DEFAULTS:{damageHp:1},process:function(t){i.a.getNearestUnits(t).some(function(t){var e=this.team,a=this.damageHp;return!(t.team===e||!Object(o.b)(this,t)||(Object(n.c)(t.AUDIO_HIT||"hit",this),t.hp-=a,t.hitTime=10,i.a.destroy(this),0))}.bind(t))}}},function(t,e,a){"use strict";var n=a(0),i=a(11);e.a={componentFlag:"canShootCannon",DEFAULTS:{lastShotTime_Cannon:0,reloadTime_Cannon:100},process:function(t){var e=t.isAttacking,a=t.attackWeapon;if(e&&"Cannon"===a){var o=Date.now();o-t.lastShotTime_Cannon>=t.reloadTime_Cannon&&(t.attackTurretPositions.forEach(function(t){var e=this.team,a=t(this),i=a.rotation,o=a.x,r=a.y,c=5*Math.cos(i),s=5*Math.sin(i),l=this.dx||0,u=this.dy||0;n.a.create("CannonShot",{team:e,x:o+this.x-l,y:r+this.y-u,dx:c+l,dy:s+u})}.bind(t)),Object(i.c)("fire",t),t.lastShotTime_Cannon=o)}}}},function(t,e,a){"use strict";var n=a(0),i=a(11);e.a={componentFlag:"canShootHeavyCannon",DEFAULTS:{lastShotTime_HeavyCannon:0,reloadTime_HeavyCannon:120},process:function(t){var e=t.isAttacking,a=t.attackWeapon;if(e&&"HeavyCannon"===a){var o=Date.now();o-t.lastShotTime_HeavyCannon>=t.reloadTime_HeavyCannon&&(t.attackTurretPositions.forEach(function(t){var e=this.team,a=t(this),i=a.rotation,o=a.x,r=a.y,c=6*Math.cos(i),s=6*Math.sin(i),l=this.dx||0,u=this.dy||0;n.a.create("HeavyCannonShot",{team:e,x:o+this.x-l,y:r+this.y-u,dx:c+l,dy:s+u})}.bind(t)),Object(i.c)("fire",t),t.lastShotTime_HeavyCannon=o)}}}},function(t,e,a){"use strict";var n=a(0),i=a(11),o={reload_LaserBolt:function(t){void 0===t&&(t=!0),this.ammo_LaserBolt<this.ammoMax_LaserBolt&&(Object(i.b)("empty"),t?this.ammo_LaserBolt++:this.ammo_LaserBolt=this.ammoMax_LaserBolt)},range_LaserBolt:20,ammo_LaserBolt:4,ammoMax_LaserBolt:4,lastShotTime_LaserBolt:0,reloadTime_LaserBolt:1e3};e.a={componentFlag:"canShootLaserBolt",DEFAULTS:o,process:function(t){var e=t.isAttacking,a=t.attackWeapon,o=t.ammo_LaserBolt;if(e&&"LaserBolt"===a){var r=Date.now();r-t.lastShotTime_LaserBolt>=t.reloadTime_LaserBolt&&o>0&&(t.attackTurretPositions.forEach(function(t){for(var e=this.team,a=this.range_LaserBolt,i=t(this),o=i.rotation,r=i.x,c=i.y,s=10*Math.cos(o),l=10*Math.sin(o),u=this.dx||0,p=this.dy||0,h=a;h>0;h--)n.a.create("LaserBolt",{team:e,rotation:o,x:r+this.x-u+s*h,y:c+this.y-p+l*h})}.bind(t)),Object(i.c)("laser",t),t.ammo_LaserBolt--,t.lastShotTime_LaserBolt=r)}}}},function(t,e,a){"use strict";var n=a(0),i=a(11),o={reload_HomingMissile:function(t){void 0===t&&(t=!0),this.ammo_HomingMissile<this.ammoMax_HomingMissile&&(Object(i.b)("empty"),t?this.ammo_HomingMissile++:this.ammo_HomingMissile=this.ammoMax_HomingMissile)},lastShotTime_HomingMissile:0,ammo_HomingMissile:40,ammoMax_HomingMissile:40};e.a={componentFlag:"canShootHomingMissile",DEFAULTS:o,process:function(t){var e=t.isAttacking,a=t.ammo_HomingMissile,o=t.attackWeapon;if(e&&"HomingMissile"===o){var r=Date.now();r-t.lastShotTime_HomingMissile>=200&&a>0&&(t.attackTarget=n.a.getNearestEnemyUnit(t,64e4),t.attackTurretPositions.forEach(function(t){var e=this.attackTarget,a=this.team,i=t(this),o=i.rotation,r=i.x,c=i.y,s=4*Math.cos(o),l=4*Math.sin(o),u=this.dx||0,p=this.dy||0;n.a.create("HomingMissile",{team:a,attackTarget:e,rotation:o,x:r+this.x-u,y:c+this.y-p,dx:s+u,dy:l+p})}.bind(t)),t.lastShotTime_HomingMissile=r,t.ammo_HomingMissile--,Object(i.c)("missile",t))}}}},function(t,e,a){"use strict";var n=a(0),i=a(11),o={reload_ClusterRocket:function(t){void 0===t&&(t=!0),this.ammo_ClusterRocket<this.ammoMax_ClusterRocket&&(Object(i.b)("empty"),t?this.ammo_ClusterRocket++:this.ammo_ClusterRocket=this.ammoMax_ClusterRocket)},lastShotTime_ClusterRocket:0,reloadTime_ClusterRocket:600,ammo_ClusterRocket:8,ammoMax_ClusterRocket:8};e.a={componentFlag:"canShootClusterRocket",DEFAULTS:o,process:function(t){var e=t.isAttacking,a=t.attackWeapon,o=t.ammo_ClusterRocket;if(e&&"ClusterRocket"===a){var r=Date.now();r-t.lastShotTime_ClusterRocket>=t.reloadTime_ClusterRocket&&o>0&&(t.attackTurretPositions.forEach(function(t){var e=this.team,a=t(this),i=a.rotation,o=a.x,r=a.y,c=2.5*Math.cos(i),s=2.5*Math.sin(i),l=this.dx||0,u=this.dy||0;n.a.create("ClusterRocket",{rotation:i,team:e,x:o+this.x-l,y:r+this.y-u,dx:c+l,dy:s+u})}.bind(t)),t.lastShotTime_ClusterRocket=r,t.ammo_ClusterRocket--,Object(i.c)("bomb-release",t))}}}},function(t,e,a){"use strict";var n={MAX_SPEED:40,MAX_SPEED2:Math.pow(40,2)};e.a={componentFlag:"canLimitSpeed",DEFAULTS:n,process:function(t){var e=Math.pow(t.dx,2)+Math.pow(t.dy,2);if(e>t.MAX_SPEED2){var a=t.MAX_SPEED*Math.pow(e,-.5);t.dx*=a,t.dy*=a}}}},function(t,e,a){"use strict";var n={accelerate:function(t){this.dx+=Math.cos(this.rotation)*t,this.dy+=Math.sin(this.rotation)*t}};e.a={componentFlag:"canAccelerate",DEFAULTS:n}},function(t,e,a){"use strict";var n=.26;e.a={componentFlag:"canAccelerateToAttackTarget",DEFAULTS:{delayBeforeTracking:5},process:function(t){if(t.delayBeforeTracking>0)t.delayBeforeTracking--;else{var e=t.attackTarget;if(e){var a=e.x,i=e.y;t.x>a?t.dx-=n:t.x<a&&(t.dx+=n),t.y>i?t.dy-=n:t.y<i&&(t.dy+=n),t.rotation=Math.atan2(t.dy,t.dx)}}}}},function(t,e,a){"use strict";function n(t,e){void 0===e&&(e=r.a),t.accelerate(e),t.flameOn()}function i(t){var e=t.attackTarget,a=t.dx,i=t.dy,f=t.isDockedPlanet,y=t.isDockedSpacePort,m=t.isFighterPreviouslyDocked;if(f)t.isFighterPreviouslyDocked=!0,t.undockPlanet(),n(t,2*r.b+r.a);else if(y)t.isFighterPreviouslyDocked=!0,t.undockSpacePort(),n(t,r.b+r.a);else{var g=void 0,v=void 0,_=o.a.getDistSquared(t,e),b=Math.pow(a,2)+Math.pow(i,2);v="PBase"===e.type?p:u;var T=o.a.getAngleFromTo(t,e),S=Math.atan2(i,a),E=Math.pow(_/r.a,.25)+l+d,x=Math.sqrt(_/b);if(m&&b<9)g=t.rotation;else{if(t.isFighterPreviouslyDocked=!1,t.isAttacking=!1,g=x<=E?S+Math.PI:T,_<h)g=S+Math.PI;else if(_<v){var O=10*Math.cos(T),w=10*Math.sin(T);g=Math.atan2(w-i,O-a),t.isAttacking=Math.abs(g-t.rotation)<2*c}!function(t,e){e>t.rotation?t.rotation+=s:t.rotation-=s}(t,g)}!t.isAttacking&&Math.abs(Math.cos(g)-Math.cos(t.rotation))<c&&n(t)}}var o=a(0),r=a(6),c=.05,s=2*r.e,l=Math.PI/r.e,u=Math.pow(400,2),p=Math.pow(600,2),h=Math.pow(275,2),d=5;e.a={componentFlag:"canAccelerateFighterToAttackTarget",DEFAULTS:{isFighterPreviouslyDocked:!1,isFighterAutoAccelerated:!0},process:function(t){t.isFighterAutoAccelerated&&function(t){var e=t.attackTarget;t.flameOff(),e&&(e.hp>0?i(t):t.attackTarget=null)}(t)}}},function(t,e,a){"use strict";e.a={componentFlag:"canDisplayHit",DEFAULTS:{hitTime:-1},process:function(t){t.renderHit&&t.renderHit()}}},function(t,e,a){"use strict";var n=a(0),i={isDockedPlanet:!1,dockPlanet:function(t){this.isDockedPlanet=!0,this.dx=0,this.dy=0,this.rotation=n.a.getAngleFromTo(t,this),this.planet=t,t.isOccupied()||(t.team=this.team,t.updateFlagColor())},undockPlanet:function(){this.isDockedPlanet=!1,this.planet=void 0}};e.a={componentFlag:"canDockPlanet",DEFAULTS:i,process:function(t){t.isDockedPlanet&&(t.x=105*Math.cos(t.rotation)+t.planet.x,t.y=105*Math.sin(t.rotation)+t.planet.y)}}},function(t,e,a){"use strict";var n={spaceport:null,isDockedSpacePort:!1,dockSpacePort:function(t){this.isDockedSpacePort=!0,this.dx=0,this.dy=0,this.rotation=t.rotation,this.spaceport=t,this.spaceport.fighter=this,this.spaceport.isCarryingFighter=!0},undockSpacePort:function(){this.spaceport.fighter=null,this.spaceport.isCarryingFighter=!1,this.spaceport=null,this.isDockedSpacePort=!1}};e.a={componentFlag:"canDockSpacePort",DEFAULTS:n,process:function(t){var e=t.isDockedSpacePort,a=t.spaceport;e&&(t.rotation=a.rotation,t.x=211*Math.cos(t.rotation)+a.planet.x,t.y=211*Math.sin(t.rotation)+a.planet.y)}}},function(t,e,a){"use strict";var n=a(11),i=a(0),o=a(5),r=a(6),c=Math.pow(7,2);e.a={componentFlag:"canCarryFighter",DEFAULTS:{fighter:null,isCarryingFighter:!1},process:function(t){t.isCarryingFighter||i.a.getNearestUnits(t).some(function(t){var e=t.dx,a=t.dy,i=t.type,s=t.team,l=t.canDockSpacePort;return!!("Fighter"===i&&s===this.team&&l&&Object(o.b)(this,t)&&Math.pow(e,2)+Math.pow(a,2)<=c)&&(Object(r.h)(s)&&Object(n.b)("repaired"),t.dockSpacePort(this),!0)}.bind(t))}}},function(t,e,a){"use strict";var n=a(0),i=a(11),o=a(24),r=a(6);e.a={componentFlag:"canColonizePlanet",DEFAULTS:{MAX_MATERIALS_FINISHED:500,colonizationTarget:null},process:function(t){var e=t.colonizationTarget,a=t.isOrbitingPlanet,c=t.planet,s=t.team;e&&a&&c&&(c.team===s?t.materialsFinished>0&&(void 0===t.supplyTime?t.supplyTime=600:t.supplyTime>0?t.supplyTime--:0===t.supplyTime&&(c.pbase?c.pcolony?c.spaceport?(function(t){var e=t.planet.pbase;if(0===e.materialsFinished){e.materialsFinished+=t.materialsFinished,t.materialsFinished=0;var a=0;e.materialsFinished>e.MAX_FINISHED_MATERIALS?(a=e.materialsFinished-e.MAX_FINISHED_MATERIALS,e.materialsFinished=e.MAX_MATERIALS_FINISHED,t.materialsFinished=a,t.unloadSupply()):(t.canExplode=!1,n.a.destroy(t))}else if(t.planet.materialsFinished>0&&t.materialsFinished<t.MAX_MATERIALS_FINISHED){var i=t.MAX_MATERIALS_FINISHED-t.materialsFinished;i>=t.planet.materialsFinished?(t.materialsFinished+=t.planet.materialsFinished,t.planet.materialsFinished=0):(t.materialsFinished+=i,t.planet.materialsFinished-=i),t.loadSupply()}}(t),t.colonizationTarget=null):(function(t){var e=t.planet,a=t.team,o=t.orbitRotation;Object(r.h)(a)&&Object(i.b)("nav"),e.spaceport=n.a.create("SpacePort",{x:e.x,y:e.y,planet:e,team:a}),e.spaceport.enterPlanetOrbit(e),e.spaceport.orbitRotation=o,t.canExplode=!1,n.a.destroy(t)}(t),o.a.displayText(s,"Colonization successful: SpacePort secured.")):(function(t){var e=t.planet,a=t.team;Object(r.h)(a)&&Object(i.b)("nav"),e.pcolony=n.a.create("PColony",{x:e.x,y:e.y,planet:e,team:a}),t.canExplode=!1,n.a.destroy(t)}(t),o.a.displayText(s,"Colonization successful: Colony secured.")):(function(t){var e=t.planet,a=t.team;Object(r.h)(a)&&Object(i.b)("nav"),e.pbase=n.a.create("PBase",{x:e.x,y:e.y,planet:e,team:a}),t.canExplode=!1,n.a.destroy(t)}(t),o.a.displayText(s,"Colonization successful: PBase secured.")))):e.isOccupied()||(e.team=s,e.updateFlagColor()))}}},function(t,e,a){"use strict";e.a={componentFlag:"canShimmer",DEFAULTS:{isShimmering:!0,isShimmerBlink:!1,shimmerTime:3,shimmerTimeMax:3,shimmerBlinkColor:16777215,shimmerNormalColor:16711935},process:function(t){if(t.isShimmering){var e=t.shimmerBlinkColor,a=t.shimmerNormalColor,n=t.shimmerTime,i=t.shimmerTimeMax,o=t.isShimmerBlink;n>0?t.shimmerTime--:(t.shimmerTime=i,t.isShimmerBlink=!o),t.geo.graphics.tint=o?e:a}else t.geo.graphics.tint=t.shimmerNormalColor}}},function(t,e,a){"use strict";var n=a(0),i=a(13),o=a(11),r=a(24),c=a(6),s={HeavyCannon:.6,ClusterRocket:.5,HomingMissile:.4,LaserBolt:.2,Shield:.7},l=function(t){return"Shield"===t};e.a={componentFlag:"candevelopEquipment",DEFAULTS:{developEquipment_installTimeMax:150,developEquipment_installTime:150,developEquipment_timeMax:1600,developEquipment_time:1600,developEquipment_equipmentReady:""},process:function(t){var e=t.developEquipment_time,a=t.developEquipment_installTime,u=t.developEquipment_installTimeMax,p=t.developEquipment_timeMax,h=t.developEquipment_equipmentReady,d=t.team;if(Boolean(h))if(t.isShimmering=!0,a>0)t.developEquipment_installTime--;else{var f=n.a.getNearestUnits(t).find(function(e){return e.team===d&&(e.isDockedPlanet&&e.planet===t.planet||e.isDockedSpacePort&&e.spaceport===t.planet.spaceport)});f&&(l(h)&&!f.shield?(f.shield=n.a.create("Shield",{team:d,anchor:f}),t.developEquipment_equipmentReady="",Object(c.h)(d)&&(Object(o.b)("install"),f.isFighterAutoAccelerated||r.a.displayText(d,h+" installed."))):"Cannon"===f.attackWeapon&&(f.attackWeapon=h,t.developEquipment_equipmentReady="",Object(c.h)(d)&&(Object(o.b)("install"),f.isFighterAutoAccelerated||r.a.displayText(d,h+" installed.")))),t.developEquipment_installTime=u}else if(t.isShimmering=!1,e>0)t.developEquipment_time--;else{t.developEquipment_time=p;var y=i.a.arrayElement(Object.keys(s));Math.random()<s[y]&&(t.developEquipment_equipmentReady=y,Object(c.h)(d)&&(Object(o.b)("develop"),r.a.displayText(d,"New equipment: "+y+" available.")))}}}},function(t,e,a){"use strict";function n(t){t.explode(t),o.a.destroy(t)}function i(t){var e=t.type;"Star"===e?function(t){var e=o.a.getDistSquared(this,t);if(e<s){var a=t.x-this.x,i=t.y-this.y,r=this.mass*t.mass/Math.pow(e,1.5);this.dx+=a*r,this.dy+=i*r,e<c.a.DIST_SURFACE2&&n(this)}}.call(this,t):"Planet"===e&&function(t){var e=o.a.getDistSquared(this,t);if(e<l){var a=this.mass*t.mass/Math.pow(e,1.5),i=t.x-this.x,c=t.y-this.y;if(this.dx+=i*a,this.dy+=c*a,e<r.a.DIST_SURFACE2){var s=this.dx*this.dx+this.dy*this.dy,d=this.rotation,f=o.a.getAngleFromTo(t,this),y=Math.abs(f-d);y>Math.PI&&(d>0?d-=h:d+=h,y=Math.abs(f-d)),y<u&&s<p?this.dockPlanet(t):n(this)}}}.call(this,t)}var o=a(0),r=a(128),c=a(129),s=Math.pow(1e3,2),l=Math.pow(800,2),u=Math.PI/4,p=Math.pow(2.1,2),h=2*Math.PI;e.a={componentFlag:"canGravitate",DEFAULTS:{},process:function(t){var e=t.isDockedPlanet,a=t.isDockedSpacePort,n=t.hp;!e&&!a&&n>0&&o.a.getBodies().forEach(i.bind(t))}}},function(t,e,a){"use strict";var n=a(0),i=Math.pow(20,2);e.a={componentFlag:"canFlock",DEFAULTS:{flockPoint:null},process:function(t){t.canMoveLinearly&&(function(t){n.a.getNearestUnits(t).filter(function(e){return e.canFlock&&e!==t}).forEach(function(e){var a=n.a.getDistSquared(t,e);if(a<i){var o=-5;a<6&&(o*=4),t.dx+=(e.x-t.x)*o,t.dy+=(e.y-t.y)*o}})}(t),function(t){var e=t.flockPoint;if(e){var a=n.a.getAngleFromTo(t,e);t.dx+=5*Math.cos(a),t.dy+=5*Math.sin(a)}}(t),function(t){var e=t.dx,a=t.dy,n=Math.atan2(a,e);t.rotation=n,t.dx=2.5*Math.cos(n),t.dy=2.5*Math.sin(n)}(t))}}},function(t,e,a){"use strict";function n(t){t.hp=0;var e=t.type.toLowerCase();t.planet&&delete t.planet[e],t.spaceport&&delete t.spaceport[e],t.fighter&&(t.fighter.hp=0,t.fighter.undockSpacePort(),delete t.fighter),t.anchor&&(t.anchor.shield=null,delete t.anchor),delete t.shield,delete t.attackTarget,delete t.colonizationTarget;var a=r(t.type),n=a.indexOf(t);-1!==n&&a.splice(n,1),i.b.removeChild(t.geo.graphics)}var i=a(15),o={},r=function(t){return o[t]||[]};e.a={add:function(t){var e=t.type;o[e]?o[e].push(t):o[e]=[t],i.b.addChild(t.geo.graphics)},remove:n,clearAll:function(){Object.keys(o).forEach(function(t){o[t].forEach(n),delete o[t]})},getByType:r}},function(t,e,a){"use strict";function n(t,e,a){var n=t.x>>o,i=t.y>>o;return n+=e||0,i+=a||0,n+i*r}var i=a(0),o=10,r=a(6).d>>o,c=function(){function t(){this.grid=[],this.nextGrid=[]}return t.prototype.prepareNext=function(){return this.grid=this.nextGrid,this.nextGrid=[],this},t.prototype.commit=function(t){var e=this.nextGrid;if(t.hp>0){var a=n(t,0,0);e[a]instanceof Array?e[a].push(t):e[a]=[t]}return this},t.prototype.get1CellRadiusAroundEntity=function(t){var e=this.grid;return[].concat(e[n(t,-1,-1)],e[n(t,0,-1)],e[n(t,1,-1)],e[n(t,-1,0)],e[n(t,0,0)],e[n(t,1,0)],e[n(t,0,1)],e[n(t,-1,1)],e[n(t,1,1)]).filter(Boolean)},t.prototype.getNearestEnemy=function(t,e){void 0===e&&(e=1/0);var a,n=this.get1CellRadiusAroundEntity(t).filter(function(e){return e.team!==t.team}),o=1/0;return n&&n.forEach(function(n){var r=Object(i.b)(t,n);r<=e&&r<o&&(o=r,a=n)}),a},t}();e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={body:{type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[-2,2,-4,0,-2,-2,-4,-4,-4,-6,2,-4,0,-2,8,0,0,2,2,4,-4,6,-4,4,-2,2],collisionPath:[-4,-6,8,0,-4,6]},flame1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-4,-4,-8,-5,-4,-6]},flame2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-4,4,-8,5,-4,6]}},c=[function(t){var e=t.geo.collider.calcPoints[1];return{x:e.x,y:e.y,rotation:t.rotation}}],s=function(t){function e(e){var a=t.call(this)||this;return a.type="Fighter",a.geo=Object(n.a)(r.body),a.mass=10,a.hp=4,a.maxHp=4,a.rotation=0,a.canGravitate=!0,a.canExplode=!0,a.canAttack=!0,a.attackWeapon="Cannon",a.attackTurretPositions=c,a.canBeShielded=!0,a.canShootLaserBolt=!0,a.canShootCannon=!0,a.canShootHeavyCannon=!0,a.canShootClusterRocket=!0,a.canShootHomingMissile=!0,a.canLimitSpeed=!0,a.canMoveLinearly=!0,a.canAccelerate=!0,a.canDockPlanet=!0,a.canDockSpacePort=!0,a.canAccelerateFighterToAttackTarget=!0,a.flameOn=function(){a.setChildVisible(0,!0),a.setChildVisible(1,!0)},a.flameOff=function(){a.setChildVisible(0,!1),a.setChildVisible(1,!1)},Object.assign(a,e),a.assignTeamColor(),a.geo.graphics.addChild(Object(n.a)(r.flame1).graphics,Object(n.a)(r.flame2).graphics),a.flameOff(),a}return o(e,t),e}(i.a);e.a=s},function(t,e,a){"use strict";var n=a(5),i=a(0),o=a(8),r=a(6),c=a(13),s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),l={body:{type:"polygon",lineStyle:{width:1,color:15658734,alpha:1},collisionPath:[-44,-4,-38,-8,26,-10,44,0,26,10,-38,8,-44,4],path:[-26,-2,-26,-8,-38,-8,-38,2,-44,4,-44,-4,-38,-2,-38,8,-26,8,-26,-2,24,-2,26,-10,44,0,26,10,24,2,-26,2]},cargopodL:{type:"polygon",lineStyle:{width:1,color:15658734,alpha:1},path:[-24,-2,-24,-12,22,-12,22,-2]},cargopodR:{type:"polygon",lineStyle:{width:1,color:15658734,alpha:1},path:[-24,2,-24,12,22,12,22,2]},flag:{type:"polygon",lineStyle:{width:2,color:255,alpha:1},path:[34,0,42,0]},turret1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[-34,0,-30,-3,-30,3,-34,0]},turret2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[28,-3,32,0,28,3,28,-2]},flame:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-44,-2,-50,0,-44,2]}},u=function(t,e,a){var n=t.attackTarget,o=(n=n||{}).dx||0,r=n.dy||0,s={x:n.x+24*o,y:n.y+24*r},l=i.a.getAngleFromTo({x:e+t.x,y:a+t.y},s);return l+=c.a.float(-.2,.2)},p=[function(t){var e=-34*Math.cos(t.rotation),a=-34*Math.sin(t.rotation);return{x:e,y:a,rotation:u(t,e,a)}},function(t){var e=32*Math.cos(t.rotation),a=32*Math.sin(t.rotation);return{x:e,y:a,rotation:u(t,e,a)}}],h=function(t){function e(e){var a=t.call(this)||this;return a.type="Freighter",a.geo=Object(n.a)(l.body),a.hp=10,a.maxHp=10,a.canDisplayHit=!0,a.canOrbitPlanet=!0,a.isOrbitingPlanet=!1,a.orbitDistance=205,a.canExplode=!0,a.canColonizePlanet=!0,a.canMoveToColonizationTarget=!0,a.canStoreMaterial=!0,a.materialsRaw=0,a.materialsFinished=500,a.canAutoTargetEnemy=!0,a.autoTargetSearchDist2=16e4,a.canAttack=!0,a.attackTurretPositions=p,a.canShootHomingMissile=!0,a.canShootLaserBolt=!0,a.canShootCannon=!0,a.reloadTime_Cannon=400,a.loadSupply=function(){a.setChildVisible(2,!0),a.setChildVisible(3,!0)},a.unloadSupply=function(){a.setChildVisible(2,!1),a.setChildVisible(3,!1)},a.flameOn=function(){return a.setChildVisible(0,!0)},a.flameOff=function(){return a.setChildVisible(0,!1)},Object.assign(a,e),a.geo.graphics.addChild(Object(n.a)(l.flame).graphics,Object(n.a)(l.flag).graphics,Object(n.a)(l.cargopodL).graphics,Object(n.a)(l.cargopodR).graphics,Object(n.a)(l.turret1).graphics,Object(n.a)(l.turret2).graphics),a.assignTeamColor(),a.flameOff(),a}return s(e,t),e.prototype.assignTeamColor=function(){this.getChildAt(1).currentPath.lineColor=r.g[this.team]},e}(o.a);e.a=h},function(t,e,a){"use strict";var n=a(5),i=a(8),o=a(0),r=a(13),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),s={_name:"Planetary Base",body:{type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[-20,20,-20,-20,20,-20,20,20,-20,20]},turret1:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[65,-60,65,-65,60,-65,65,-60]},turret2:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[-65,-60,-65,-65,-60,-65,-65,-60]},turret3:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[65,60,65,65,60,65,65,60]},turret4:{type:"polygon",lineStyle:{width:1,color:65280,alpha:.5},path:[-65,60,-65,65,-60,65,-65,60]}},l=function(t,e,a){var n=t.attackTarget,i=n.dx||0,c=n.dy||0,s={x:n.x+24*i,y:n.y+24*c},l=o.a.getAngleFromTo({x:e+t.x,y:a+t.y},s);return l+=r.a.float(-.2,.2)},u=[function(t){return{x:65,y:65,rotation:l(t,65,65)}},function(t){return{x:65,y:-65,rotation:l(t,65,-65)}},function(t){return{x:-65,y:-65,rotation:l(t,-65,-65)}},function(t){return{x:-65,y:65,rotation:l(t,-65,65)}}],p=function(t){function e(e){var a=t.call(this)||this;return a.type="PBase",a.geo=Object(n.a)(s.body),a.hp=20,a.maxHp=20,a.canDisplayHit=!0,a.canExplode=!0,a.canHarvest=!0,a.canRepair=!0,a.canRefine=!0,a.canConstruct=!0,a.canOccupyPlanet=!0,a.canStoreMaterial=!0,a.materialsRaw=0,a.materialsFinished=0,a.canAutoTargetEnemy=!0,a.autoTargetSearchDist2=36e4,a.canAttack=!0,a.attackTurretPositions=u,a.canShootCannon=!0,a.reloadTime_Cannon=400,Object.assign(a,e),a.assignTeamColor(),a.geo.graphics.addChild(Object(n.a)(s.turret1).graphics,Object(n.a)(s.turret2).graphics,Object(n.a)(s.turret3).graphics,Object(n.a)(s.turret4).graphics),a}return c(e,t),e}(i.a);e.a=p},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={type:"polygon",_name:"Planetary Colony",lineStyle:{width:1,color:255,alpha:1},path:[-30,40,-70,40,-70,-40,-30,-40,-30,40]},c=function(t){function e(e){var a=t.call(this)||this;return a.type="PColony",a.geo=Object(n.a)(r),a.hp=15,a.maxHp=15,a.canDisplayHit=!0,a.canMine=!0,a.canExplode=!0,a.explosionOriginDx=-50,a.explosionOriginDy=0,a.canManufacture=!0,a.PRODUCT={Freighter:{cost:300,time:120},Fighter:{cost:500,time:90}},a.canOccupyPlanet=!0,a.canRepair=!0,a.REPAIR_COST_FINISHED=10,a.REPAIR_TIME=20,Object.assign(a,e),a.assignTeamColor(),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={type:"polygon",_name:"Planetary Communications Center",lineStyle:{width:1,color:255,alpha:1},path:[40,30,0,30,0,50,40,50,40,30,60,35,30,10,40,30]},c=function(t){function e(e){var a=t.call(this)||this;return a.type="PComm",a.geo=Object(n.a)(r),a.hp=7,a.maxHp=7,a.canDisplayHit=!0,a.canExplode=!0,a.explosionOriginDx=31,a.explosionOriginDy=33,a.canRepair=!0,a.canOccupyPlanet=!0,a.REPAIR_COST_FINISHED=2,a.REPAIR_TIME=10,Object.assign(a,e),a.assignTeamColor(),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={type:"polygon",_name:"Planetary Lab",lineStyle:{width:1,color:16777215,alpha:1},path:[0,-40,0,-70,50,-70,50,-40,0,-40]},c=function(t){function e(e){var a=t.call(this)||this;a.type="PLab",a.geo=Object(n.a)(r),a.hp=10,a.maxHp=10,a.canShimmer=!0,a.isShimmering=!1,a.shimmerBlinkColor=1044495,a.canDevelopEquipment=!0,a.canDisplayHit=!0,a.canExplode=!0,a.explosionOriginDx=20,a.explosionOriginDy=-52,a.canOccupyPlanet=!0,Object.assign(a,e);var i=a.assignTeamColor();return a.shimmerNormalColor=i,a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={body:{type:"polygon",lineStyle:{width:1,color:16711935,alpha:1},path:[-4,1,0,2,4,0,0,-2,-4,-1,-4,1],collisionPath:[-4,2,0,4,8,0,0,-4,-4,-2]},flame:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-4,-4,-8,-5,-4,-6]}},c=function(t){function e(e){var a=t.call(this)||this;return a.type="Probe",a.geo=Object(n.a)(r.body),a.hp=2,a.maxHp=2,a.canMoveLinearly=!0,a.canFlock=!0,a.flameOn=function(){return a.setChildVisible(0,!0)},a.flameOff=function(){return a.setChildVisible(0,!1)},Object.assign(a,e),a.assignTeamColor(),a.geo.graphics.addChild(Object(n.a)(r.flame).graphics),a.flameOff(),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={_name:"Orbital Sensor Array",type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[6,26,12,28,12,40,18,46,18,34,12,40,6,42]},c=function(t){function e(e){var a=t.call(this)||this;return a.type="SensorArray",a.geo=Object(n.a)(r),a.hp=5,a.maxHp=5,a.canExplode=!0,a.canDisplayHit=!0,a.canRepair=!0,a.canOccupySpacePort=!0,Object.assign(a,e),a.assignTeamColor(),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={_name:"Space Dock",type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[6,-42,20,-42,20,-22,14,-26,6,-26]},c=function(t){function e(e){var a=t.call(this)||this;return a.type="SpaceDock",a.geo=Object(n.a)(r),a.hp=8,a.maxHp=8,a.canExplode=!0,a.canDisplayHit=!0,a.canRepair=!0,a.canManufacture=!0,a.PRODUCT={Fighter:{cost:200,time:60},Probe:{cost:15,time:10}},a.canOccupySpacePort=!0,Object.assign(a,e),a.assignTeamColor(),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=a(0),r=a(13),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),s={_name:"Space Port",body:{type:"polygon",lineStyle:{width:1,color:255,alpha:1},path:[-2,0,-6,-20,-6,-36,-2,-44,6,-44,6,-24,2,-20,2,20,6,24,6,44,-2,44,-6,36,-6,20,-2,0]},turret1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[0,28,4,26,4,30,0,28]},turret2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[0,-28,4,-26,4,-30,0,-28]},turret3:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[4,44,2,48,0,44]},turret4:{type:"polygon",lineStyle:{width:1,color:65535,alpha:.5},path:[4,-44,2,-48,0,-44]},flame1:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,20,-12,22,-6,24]},flame2:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,-24,-12,-22,-6,-20]},flame3:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,32,-12,34,-6,36]},flame4:{type:"polygon",lineStyle:{width:1,color:65535,alpha:1},path:[-6,-36,-12,-34,-6,-32]}},l=function(t,e,a){var n=t.attackTarget,i=n.dx||0,c=n.dy||0,s={x:n.x+20*i,y:n.y+20*c},l=o.a.getAngleFromTo({x:e+t.x,y:a+t.y},s);return l+=r.a.float(-.15,.15)},u=Math.PI/2,p=[function(t){var e=28*Math.cos(t.rotation-u),a=28*Math.sin(t.rotation-u);return{x:e,y:a,rotation:l(t,e,a)}},function(t){var e=-28*Math.cos(t.rotation-u),a=-28*Math.sin(t.rotation-u);return{x:e,y:a,rotation:l(t,e,a)}},function(t){var e=46*Math.cos(t.rotation-u),a=46*Math.sin(t.rotation-u);return{x:e,y:a,rotation:l(t,e,a)}},function(t){var e=-46*Math.cos(t.rotation-u),a=-46*Math.sin(t.rotation-u);return{x:e,y:a,rotation:l(t,e,a)}}],h=function(t){function e(e){var a=t.call(this)||this;return a.type="SpacePort",a.geo=Object(n.a)(s.body),a.hp=35,a.maxHp=35,a.canRepair=!0,a.canRefine=!0,a.canOrbitPlanet=!0,a.orbitDistance=205,a.canAutoTargetEnemy=!0,a.canDisplayHit=!0,a.canExplode=!0,a.canAttack=!0,a.attackTurretPositions=p,a.canShootCannon=!0,a.reloadTime_Cannon=300,a.canCarryFighter=!0,a.canStoreMaterial=!0,a.materialsRaw=0,a.materialsFinished=0,Object.assign(a,e),a.assignTeamColor(),a.geo.graphics.addChild(Object(n.a)(s.flame1).graphics,Object(n.a)(s.flame2).graphics,Object(n.a)(s.flame3).graphics,Object(n.a)(s.flame4).graphics,Object(n.a)(s.turret1).graphics,Object(n.a)(s.turret2).graphics,Object(n.a)(s.turret3).graphics,Object(n.a)(s.turret4).graphics),a}return c(e,t),e}(i.a);e.a=h},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={type:"circle",radius:20,collisionRadius:10,fill:{color:0,alpha:0},lineStyle:{width:1,color:65535,alpha:1}},c=function(t){function e(e){var a=t.call(this)||this;return a.type="Shield",a.hp=12,a.maxHp=12,a.geo=Object(n.a)(r),a.canDisplayHit=!0,a.canAnchor=!0,Object.assign(a,e),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={type:"polygon",fill:{color:16777215,alpha:1},path:[-1,1,1,1,1,-1,-1,-1,-1,1]},c=function(t){function e(e){var a=t.call(this)||this;return a.type="CannonShot",a.canMoveLinearly=!0,a.canDamage=!0,a.canMetabolize=!0,a.hp=60,a.damageHp=1,a.geo=Object(n.a)(r),Object.assign(a,e),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={type:"polygon",lineStyle:{width:2,color:16777215,alpha:1},path:[-3,0,0,0,0,-3,0,0,0,3,0,0,3,0]},c=function(t){function e(e){var a=t.call(this)||this;return a.type="HeavyCannonShot",a.canShimmer=!0,a.shimmerNormalColor=65535,a.canMoveLinearly=!0,a.canDamage=!0,a.canMetabolize=!0,a.hp=40,a.damageHp=2,a.geo=Object(n.a)(r),Object.assign(a,e),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=a(13),r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),c={type:"polygon",lineStyle:{width:1,color:16776960,alpha:1},path:[5,0,-5,0]},s=function(t){function e(e){var a=t.call(this)||this;return a.type="LaserBolt",a.canMoveLinearly=!0,a.canDamage=!0,a.canMetabolize=!0,a.hp=o.a.int(2,3),a.damageHp=30,a.geo=Object(n.a)(c),Object.assign(a,e),a}return r(e,t),e}(i.a);e.a=s},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={missileBody:{type:"polygon",lineStyle:{width:1,color:16777215,alpha:1},path:[0,0,6,0]},missileFlame:{type:"polygon",lineStyle:{width:1,color:16711680,alpha:1},path:[0,0,-3,0]}},c=function(t){function e(e){var a=t.call(this)||this;return a.type="HomingMissile",a.canShimmer=!0,a.shimmerNormalColor=15597568,a.canMoveLinearly=!0,a.canLimitSpeed=!0,a.MAX_SPEED=55,a.MAX_SPEED2=3025,a.canAccelerateToAttackTarget=!0,a.canDamage=!0,a.canMetabolize=!0,a.canAttack=!0,a.hp=60,a.damageHp=6,a.geo=Object(n.a)(r.missileBody),a.geo.graphics.addChild(Object(n.a)(r.missileFlame).graphics),Object.assign(a,e),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";var n=a(5),i=a(8),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),r={missileBody:{type:"polygon",lineStyle:{width:2,color:4474111,alpha:1},path:[0,0,8,0]},missileFlame:{type:"polygon",lineStyle:{width:1,color:16776960,alpha:1},path:[0,0,-2,0]}},c=function(t){function e(e){var a=t.call(this)||this;return a.type="ClusterRocket",a.geo=Object(n.a)(r.missileBody),a.canExplode=!0,a.EXPLOSION_FRAGMENTS=20,a.EXPLOSION_SOUND="fire-heavy",a.canMoveLinearly=!0,a.canDamage=!0,a.canMetabolize=!0,a.canAttack=!0,a.hp=45,a.damageHp=.5,a.geo.graphics.addChild(Object(n.a)(r.missileFlame).graphics),Object.assign(a,e),a}return o(e,t),e}(i.a);e.a=c},function(t,e,a){"use strict";e.a=function(t,e){var a=n.f[t];if("Star"===e.type){var l=o.a.float(-Math.PI,Math.PI),u={x:e.x+1e3*Math.cos(l),y:e.y+1e3*Math.sin(l)};(h=i.a.create("Fighter",{x:u.x+o.a.int(-100,100),y:u.y+o.a.int(-100,100),attackWeapon:o.a.arrayElement(s),isFighterAutoAccelerated:!Object(n.h)(a),reloadTime_HeavyCannon:60,team:a})).shield=i.a.create("Shield",{x:h.x,y:h.y,team:a,anchor:h}),i.a.create("Freighter",{x:u.x+o.a.int(-100,100),y:u.y+o.a.int(-100,100),team:a,isOrbitingPlanet:!1,materialsFinished:500}),i.a.create("Freighter",{x:u.x+o.a.int(-100,100),y:u.y+o.a.int(-100,100),team:a,attackWeapon:"HomingMissile",ammo_HomingMissile:240,target:h,isOrbitingPlanet:!1,materialsFinished:500}),i.a.create("Freighter",{x:u.x+o.a.int(-100,100),y:u.y+o.a.int(-100,100),team:a,attackWeapon:"HomingMissile",isOrbitingPlanet:!1,materialsFinished:500}),i.a.create("Freighter",{x:u.x+o.a.int(-100,100),y:u.y+o.a.int(-100,100),team:a,isOrbitingPlanet:!1,materialsFinished:500}),r.a.displayText(a,"Invasion fleet en route to hostile world.")}else{var p={team:a,planet:e},h=i.a.create("Fighter",{isFighterAutoAccelerated:!Object(n.h)(a),team:a});h.dockPlanet(e),e.pbase=i.a.create("PBase",p),e.pcolony=i.a.create("PColony",p),e.plab=i.a.create("PLab",p),e.pcomm=i.a.create("PComm",p),e.spaceport=i.a.create("SpacePort",p);var d=c({},p,{spaceport:e.spaceport});e.spacedock=i.a.create("SpaceDock",d),e.sensorarray=i.a.create("SensorArray",d),e.team=a,e.updateFlagColor(),i.a.getByType("Planet").filter(function(t){return t.star===e.star&&t!==e}).forEach(function(t){t.team=a,t.updateFlagColor()})}};var n=a(6),i=a(0),o=a(13),r=a(24),c=this&&this.__assign||Object.assign||function(t){for(var e,a=1,n=arguments.length;a<n;a++){e=arguments[a];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},s=["Cannon","HeavyCannon","LaserBolt","HomingMissile","ClusterRocket"]},function(t,e,a){"use strict";function n(t){return!t.pbase||!t.pcolony}function i(t){return t.pcolony&&!t.pcolony.isManufacturing}function o(t,e,a){if(e){var n=void 0;if(Object(_.h)(t)&&u){var i=u.pcolony;i&&!i.isManufacturing&&(n=i)}n||(n=f.a.arrayElement(e).pcolony),n&&n.orderManufacture(a)}}function r(t){var e=t.planet,a=t.isDockedPlanet,n=t.team,i=t.isDockedSpacePort,o=t.reload_HomingMissile,r=t.reload_ClusterRocket,c=t.reload_LaserBolt,s=!1;i?(t.hp<t.maxHp&&(s=Object(_.h)(n),t.hp=t.maxHp,v.a.displayText(t.team,"Fully repaired.")),o&&t.reload_HomingMissile(!1),r&&t.reload_ClusterRocket(!1),c&&t.reload_LaserBolt(!1)):a&&n===e.team&&e.isOccupied()&&(o&&t.reload_HomingMissile(),r&&t.reload_ClusterRocket(),c&&t.reload_LaserBolt(),t.hp<t.maxHp&&(s=Object(_.h)(n),t.hp+=.5,v.a.displayText(t.team,"Repairing: "+Math.round(t.hp/t.maxHp*100)+"%"))),s&&Object(g.b)("repaired")}function c(t){if(!t.colonizationTarget){var e,a=1/0;h.a.getByType("Planet").forEach(function(n){var i=h.a.getDistSquared(t,n);a>i&&(e=n,a=i)}),e&&(t.exitPlanetOrbit(),t.colonizationTarget=e)}}function s(t,e){var a=t.planet===u||t.spaceport&&t.spaceport.planet===u;return((e.planet===u||e.spaceport&&e.spaceport.planet===u)>>0)-(a>>0)}function l(t){var e,a=function(e){return e.team===t},l=function(e){return e.team!==t},g=h.a.getByType("Planet").filter(a),b=h.a.getByType("PColony").filter(a),T=h.a.getByType("Freighter").filter(a),E=h.a.getByType("Fighter").filter(a);if(e=g.filter(i),e=e.length>0?e:void 0,0===g.length&&T.length>0?T.forEach(c):g.filter(n).forEach(function(t,e){var a=!1;if(t.length>0){for(var n=t.length-1;n>=0;n--){var i=t[n];if(!Boolean(i.colonizationTarget)){i.isOrbitingPlanet&&i.exitPlanetOrbit(),i.colonizationTarget=e,a=!0;break}}a&&v.a.displayText(t[0].team,"Freighter fleet heading towards target.")}}.bind(null,T)),E.length<g.length&&o(t,e,"Fighter"),E.length>0){var x=f.a.arrayElement(E);if(Object(_.h)(t)&&(u&&!Object(_.h)(u.team)&&(u=null),d.a.getControlledEntity()||(x=E.filter(function(t){return!t.isFighterAutoAccelerated||!t.attackTarget&&(t.planet||t.spaceport)}).sort(s)[0])&&(x.isFighterAutoAccelerated=!1,d.a.setControlledEntity(x),y.a.setFocus(x),m.a.init())),x&&!x.attackTarget&&x.isFighterAutoAccelerated){var O=Math.random(),w=void 0;O<.1?(w=f.a.arrayElement(h.a.getByType("Freighter").filter(l)),v.a.displayText(t,"Friendly Fighter targeting enemy Freighter!")):O<.3&&(w=f.a.arrayElement(h.a.getByType("PBase").filter(l)),v.a.displayText(t,"Friendly Fighter targeting enemy planet!")),w&&(x.attackTarget=w)}}E.forEach(r),g.length>T.length&&o(t,e,"Freighter"),0===b.length&&0===E.length&&0===T.length&&(p=p.filter(function(e){return e!==t}),S(t))}var u,p,h=a(0),d=a(44),f=a(13),y=a(43),m=a(65),g=a(11),v=a(24),_=a(6),b=0,T=[_.f.GREEN,_.f.BLUE,_.f.YELLOW,_.f.RED,_.f.MAGENTA],S=new Function,E=new Function;e.a={init:function(){p=T.slice()},update:function(){var t=Date.now();t-b>3e3&&(p.forEach(l),1===p.length&&E(p[0]),b=t)},setHumanTeamHomePlanet:function(t){u=t},setOnTeamLostCallback:function(t){return S=t},setOnTeamWinCallback:function(t){return E=t}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(34)),o=a(35);e.a={create:function(t){var e=t.onClickSetHomePlanet,a=t.onClickSwapWeapon,r=t.onClickDone,c=i.a.create({width:400,height:250}),s=250;s-=60;var l=o.a.create({text:"Done",width:360,onClick:function(){i.a.destroy(c),r()}});l.x=20,l.y=s,s-=60;var u=o.a.create({text:"Swap weapon",width:360,onClick:function(){i.a.destroy(c),a()}});u.x=20,u.y=s,s-=60;var p=o.a.create({text:"Set as home planet",width:360,onClick:function(){i.a.destroy(c),e()}});p.x=20,p.y=s;var h=new n.Text("Fighter is docked to friendly facilities.",{fontFamily:"arial",fontSize:12,fill:16777215,align:"center"});return h.x=(400-h.width)/2,h.y=30,c.modal.addChild(h),c.buttons.push(p),c.modal.addChild(p),c.buttons.push(u),c.modal.addChild(u),c.buttons.push(l),c.modal.addChild(l),c}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(34)),o=a(35),r="Cannon";e.a={create:function(t){var e=t.fighter,a=t.onClickWeapon,c=e.attackWeapon,s=(e.planet?e.planet:e.spaceport.planet).plab,l=s&&s.developEquipment_equipmentReady,u=i.a.create({width:400,height:200}),p=200;[r,l].filter(Boolean).map(function(t){p-=60;var n=o.a.create({text:"Switch to "+t,width:360,onClick:function(){s&&"Shield"!==s.developEquipment_equipmentReady&&(e.attackWeapon=s.developEquipment_equipmentReady||r,s.developEquipment_equipmentReady=c===r?"":c),a(),i.a.destroy(u)}});n.x=20,n.y=p,u.modal.addChild(n),u.buttons.push(n)}),u.buttons.reverse();var h=new n.Text("Fighter is armed with "+e.attackWeapon+".",{fontFamily:"arial",fontSize:12,fill:16777215,align:"center"});return h.x=(400-h.width)/2,h.y=30,u.modal.addChild(h),u}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(34)),o=a(35);e.a={create:function(t){var e=t.onClickContinue,a=i.a.create({width:400,height:300}),r=300;r-=60;var c=o.a.create({text:"Continue to next sector",width:360,onClick:function(){i.a.destroy(a),e()}});c.x=20,c.y=r;var s=new n.Text("GALAXY CONQUERED\n\nAll enemies in this sector have been eradicated!\nYour empire encompasses all known worlds in this galaxy.",{fontFamily:"arial",fontSize:12,fill:16777215,align:"center"});return s.x=(400-s.width)/2,s.y=40,a.buttons.push(c),a.modal.addChild(c),a.modal.addChild(s),a}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(34)),o=a(35);e.a={create:function(t){var e=t.onClickContinue,a=i.a.create({width:400,height:200}),r=200;r-=60;var c=o.a.create({text:"Retreat to a different sector",width:360,onClick:function(){i.a.destroy(a),e()}});c.x=20,c.y=r;var s=new n.Text("GALAXY LOST\n\nFriendly forces have been vanquished!\nYour empire has failed to establish\na foothold in this galaxy.",{fontFamily:"arial",fontSize:12,fill:16777215,align:"center"});return s.x=(400-s.width)/2,s.y=30,a.buttons.push(c),a.modal.addChild(c),a.modal.addChild(s),a}}},function(t,e,a){"use strict";e.a=function(t,e,a){void 0===a&&(a=!1);var n;return function(){var i=this,o=arguments;clearTimeout(n),n=setTimeout(function(){n=null,a||t.apply(i,o)},e),a&&!n&&t.apply(i,o)}}},function(t,e,a){"use strict";function n(){var t=Date.now(),e=t-r,a=!0;_||u.a.update(b),e>h&&(_?(s.b.setGlobalAlpha(g),g>0?g-=v:(g=1,a=!1)):(d.x=Math.cos(y)*f,d.y=Math.sin(y)*f,y+=m,s.b.centerOn(d),l.a.process(d)),s.b.render(),r=t-e%h),a?o=requestAnimationFrame(n):i()}function i(){cancelAnimationFrame(o),c&&c()}var o,r,c,s=a(15),l=a(65),u=a(341),p=a(342),h=1e3/60,d={x:0,y:0},f=600,y=0,m=Math.PI/180*.02,g=1,v=.05,_=!1,b=p.a.create({onClickNewGame:function(){return _=!0}});e.a={setFadeOutCallback:function(t){c=t},start:function(){s.b.init(),l.a.init().forEach(s.b.addChild),s.b.addChildToHUD(b.modal),r=Date.now(),n()},stop:i}},function(t,e,a){"use strict";var n=a(66),i=0;e.a={update:function(t){var e=Date.now(),a=e-i;if(a>62.5){var o=n.a.getDevice(),r=o.getInputState;(0,o.getEvents)();var c=r();c.up||c.up_arrow?t.prevButton():c.down||c.down_arrow?t.nextButton():(c.f||c.button0||c.button1||c.button2||c.button3)&&t.clickButton(),i=e-a%62.5}}}},function(t,e,a){"use strict";var n=a(7),i=(a.n(n),a(34)),o=a(35),r=a(6),c=a(5),s=function(){return window.open("how-to-play","_blank")},l=function(){return window.open("http://github.com/jsyang/celestial","_blank")};e.a={create:function(t){var e=t.onClickNewGame,a=i.a.create({width:340,height:360}),u=new n.Text("Build: Thu Jan 25 2018 -- 3ebc67c\n",{fontFamily:"arial",fontSize:12,fill:1122833,align:"left"});u.x=0,u.y=370,a.modal.addChild(u);var p=360;p-=60;var h=o.a.create({text:"GitHub project",onClick:l});h.x=20,h.y=p,a.modal.addChild(h),p-=60;var d=o.a.create({text:"How to play",onClick:s});d.x=20,d.y=p,a.modal.addChild(d),p-=60;var f=o.a.create({text:"New game",onClick:e});f.x=20,f.y=p,a.modal.addChild(f),a.buttons.push(f),a.buttons.push(d),a.buttons.push(h);var y=new n.Graphics;y.lineStyle(2,16776960,1);var m,g,v=.0625,_=.05;m=40,g=60,"celestial".split("").forEach(function(t){y.drawPolygon(Object(c.c)(r.c[t],m,g,v,_)),m+=30}),m=90,g=100,"combat".split("").forEach(function(t){y.drawPolygon(Object(c.c)(r.c[t],m,g,v,_)),m+=30});var b=new n.Graphics;return m=190,g=20,v=1/3,_=1/3,b.lineStyle(12,3355392,1),b.drawPolygon(Object(c.c)(r.c.symbol[0],m,g,v,_)),b.lineStyle(32,3355392,1),b.drawPolygon(Object(c.c)(r.c.symbol[1],m,g,v,_)),a.modal.addChild(b),a.modal.addChild(y),a}}},function(t,e,a){"use strict";var n=a(11),i=a(344),o=a.n(i),r=a(396),c=a.n(r),s=/(^sounds\/|\.ogg$)/gi,l=/\.ogg$/i;e.a={load:function(){return new Promise(function(t,e){c.a.getBinaryContent("assets.zip",function(a,n){a?e(a):t(n)})}).then(function(t){return o.a.loadAsync(t)}).then(function(t){return function(e){var a=[],i=[];return t.folder("sounds/").forEach(function(t,e){l.test(t)&&(a.push(e.name.replace(s,"")),i.push(e.async("arraybuffer")))}),Promise.all(i).then(function(t){return t.forEach(function(t,e){return Object(n.a)({name:a[e],arrayBuffer:t})})})}()})}}},,,,,,function(t,e){}],[158]);